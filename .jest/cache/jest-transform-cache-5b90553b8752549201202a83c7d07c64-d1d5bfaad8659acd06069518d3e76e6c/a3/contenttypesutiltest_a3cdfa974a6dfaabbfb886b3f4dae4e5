2d37a87fdc99fbd45f0d226c69a24d26
const {
  isScalarAttribute,
  isMediaAttribute,
  getPrivateAttributes,
  getTimestampsAttributes,
  isPrivateAttribute,
  getNonWritableAttributes,
  getWritableAttributes,
  getNonVisibleAttributes,
  getVisibleAttributes,
  hasDraftAndPublish,
  isDraft,
  isSingleType,
  isCollectionType,
  isKind
} = require('../content-types.util');

const _ = require('lodash');

describe('Content types util', () => {
  test('Should is scalar attribute', () => {
    const attribute = {
      type: 'test'
    };
    expect(isScalarAttribute(attribute)).toBe(true);
  });
  test('Should is not scalar attribute', () => {
    const attribute = {
      collection: jest.fn(),
      model: jest.fn(),
      type: 'component'
    };
    expect(isScalarAttribute(attribute)).toBe(false);
  });
  describe('Media attribute', () => {
    test('Should is media attribute when collection is file', () => {
      const attribute = {
        collection: 'file',
        plugin: 'upload'
      };
      expect(isMediaAttribute(attribute)).toBeTruthy();
    });
    test('Should is media attribute when model is file', () => {
      const attribute = {
        model: 'file',
        plugin: 'upload'
      };
      expect(isMediaAttribute(attribute)).toBeTruthy();
    });
    test('Should is not media attribute', () => {
      const attribute = {
        model: 'text',
        plugin: 'upload'
      };
      expect(isMediaAttribute(attribute)).toBeFalsy();
    });
  });
  test('Should get private attributes', () => {
    const model = {
      attributes: {
        password: {
          private: true
        }
      },
      options: {
        privateAttributes: []
      }
    };
    const config = {
      api: {
        responses: {
          privateAttributes: []
        }
      }
    };
    global.sgApp = {
      config: { ...config,

        get(path, defaultValue) {
          return _.get(config, path, defaultValue);
        },

        set(path, val) {
          _.set(config, path, val);

          return this;
        },

        has(path) {
          return _.has(config, path);
        }

      }
    };
    const resp = getPrivateAttributes(model);
    expect(resp).toEqual(['password']);
  });
  test('Should get timestamps attributes', () => {
    expect(getTimestampsAttributes()).toEqual({});
    expect(getTimestampsAttributes({
      options: {
        timestamps: {}
      }
    })).toEqual({});
    expect(getTimestampsAttributes({
      options: {
        timestamps: ['test']
      }
    })).toEqual({
      test: {
        type: 'timestamp'
      }
    });
  });
  describe('Is Private Attribute', () => {
    test('Should is private attribute', () => {
      expect(isPrivateAttribute({
        privateAttributes: ['att']
      }, 'att')).toEqual(true);
    });
    test('Should is not private attribute when model is empty', () => {
      expect(isPrivateAttribute()).toBeFalsy();
    });
  });
  test('Should get non writable attributes', () => {
    expect(getNonWritableAttributes()).toEqual(['id', 'created_by', 'updated_by', undefined]);
    expect(getNonWritableAttributes({
      attributes: {
        test: {
          writable: false
        },
        test1: {
          writable: true
        }
      }
    })).toEqual(['id', 'created_by', 'updated_by', undefined, 'test']);
  });
  test('Should get writable attributes', () => {
    expect(getWritableAttributes({
      attributes: {
        test: {
          writable: false
        }
      }
    })).toEqual([]);
  });
  describe('Non visible attributes', () => {
    test('Should get non visible attributes', () => {
      expect(getNonVisibleAttributes({
        attributes: {
          test: {
            writable: false
          }
        },
        primary: 'abc'
      })).toEqual([undefined, 'id', 'created_by', 'updated_by', 'published_at']);
    });
  });
  describe('Visible attributes', () => {
    test('Should get visible attributes', () => {
      expect(getVisibleAttributes({
        attributes: {
          test: {
            writable: false
          }
        },
        primary: 'abc'
      })).toEqual(['test']);
    });
  });
  describe('Draft and publish', () => {
    test('Should has draft and publish', () => {
      expect(hasDraftAndPublish({
        options: {
          draftAndPublish: true
        }
      })).toEqual(true);
    });
    test('Should has not draft and publish', () => {
      expect(hasDraftAndPublish({
        options: {
          draftAndPublish: false
        }
      })).toEqual(false);
    });
  });
  describe('Draft', () => {
    test('Should is draft', () => {
      expect(isDraft({
        published_at: null
      }, {
        options: {
          draftAndPublish: true
        }
      })).toEqual(true);
    });
    test('Should is not draft', () => {
      expect(isDraft({
        published_at: null
      }, {
        options: {
          draftAndPublish: false
        }
      })).toEqual(false);
    });
  });
  describe('Single type', () => {
    test('Should is single type', () => {
      expect(isSingleType({
        kind: 'singleType'
      })).toBeTruthy();
    });
    test('Should is not single type', () => {
      expect(isSingleType({
        kind: 'test'
      })).toBeFalsy();
    });
    test('Should is not single type with default kind', () => {
      expect(isSingleType({})).toBeFalsy();
    });
  });
  describe('Collection type', () => {
    test('Should is collection type', () => {
      expect(isCollectionType({
        kind: 'collectionType'
      })).toBeTruthy();
    });
    test('Should is not collection type', () => {
      expect(isCollectionType({
        kind: 'test'
      })).toBeFalsy();
    });
    test('Should is collection type with default kind', () => {
      expect(isCollectionType({})).toBeTruthy();
    });
  });
  describe('Kind', () => {
    test('Should is kind', () => {
      expect(isKind('test')({
        kind: 'test'
      })).toEqual(true);
    });
    test('Should is not kind', () => {
      expect(isKind('test')({
        kind: 'test1'
      })).toEqual(false);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbnRlbnQtdHlwZXMudXRpbC50ZXN0LmpzIl0sIm5hbWVzIjpbImlzU2NhbGFyQXR0cmlidXRlIiwiaXNNZWRpYUF0dHJpYnV0ZSIsImdldFByaXZhdGVBdHRyaWJ1dGVzIiwiZ2V0VGltZXN0YW1wc0F0dHJpYnV0ZXMiLCJpc1ByaXZhdGVBdHRyaWJ1dGUiLCJnZXROb25Xcml0YWJsZUF0dHJpYnV0ZXMiLCJnZXRXcml0YWJsZUF0dHJpYnV0ZXMiLCJnZXROb25WaXNpYmxlQXR0cmlidXRlcyIsImdldFZpc2libGVBdHRyaWJ1dGVzIiwiaGFzRHJhZnRBbmRQdWJsaXNoIiwiaXNEcmFmdCIsImlzU2luZ2xlVHlwZSIsImlzQ29sbGVjdGlvblR5cGUiLCJpc0tpbmQiLCJyZXF1aXJlIiwiXyIsImRlc2NyaWJlIiwidGVzdCIsImF0dHJpYnV0ZSIsInR5cGUiLCJleHBlY3QiLCJ0b0JlIiwiY29sbGVjdGlvbiIsImplc3QiLCJmbiIsIm1vZGVsIiwicGx1Z2luIiwidG9CZVRydXRoeSIsInRvQmVGYWxzeSIsImF0dHJpYnV0ZXMiLCJwYXNzd29yZCIsInByaXZhdGUiLCJvcHRpb25zIiwicHJpdmF0ZUF0dHJpYnV0ZXMiLCJjb25maWciLCJhcGkiLCJyZXNwb25zZXMiLCJnbG9iYWwiLCJzZ0FwcCIsImdldCIsInBhdGgiLCJkZWZhdWx0VmFsdWUiLCJzZXQiLCJ2YWwiLCJoYXMiLCJyZXNwIiwidG9FcXVhbCIsInRpbWVzdGFtcHMiLCJ1bmRlZmluZWQiLCJ3cml0YWJsZSIsInRlc3QxIiwicHJpbWFyeSIsImRyYWZ0QW5kUHVibGlzaCIsInB1Ymxpc2hlZF9hdCIsImtpbmQiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU07QUFDSkEsRUFBQUEsaUJBREk7QUFFSkMsRUFBQUEsZ0JBRkk7QUFHSkMsRUFBQUEsb0JBSEk7QUFJSkMsRUFBQUEsdUJBSkk7QUFLSkMsRUFBQUEsa0JBTEk7QUFNSkMsRUFBQUEsd0JBTkk7QUFPSkMsRUFBQUEscUJBUEk7QUFRSkMs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QUMzQkcsTUFBQUEsTUFBTSxDQUFDUCxNQUFNLENBQUMsTUFBRCxDQUFOLENBQWU7QUFBRXlDLFFBQUFBLElBQUksRUFBRTtBQUFSLE9BQWYsQ0FBRCxDQUFOLENBQXlDUixPQUF6QyxDQUFpRCxJQUFqRDtBQUNELEtBRkcsQ0FBSjtBQUlBN0IsSUFBQUEsSUFBSSxDQUFDLG9CQUFELEVBQXVCLE1BQU07QUFDL0JHLE1BQUFBLE1BQU0sQ0FBQ1AsTUFBTSxDQUFDLE1BQUQsQ0FBTixDQUFlO0FBQUV5QyxRQUFBQSxJQUFJLEVBQUU7QUFBUixPQUFmLENBQUQsQ0FBTixDQUEwQ1IsT0FBMUMsQ0FBa0QsS0FBbEQ7QUFDRCxLQUZHLENBQUo7QUFHRCxHQVJPLENBQVI7QUFTRCxDQTNPTyxDQUFSIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qge1xuICBpc1NjYWxhckF0dHJpYnV0ZSxcbiAgaXNNZWRpYUF0dHJpYnV0ZSxcbiAgZ2V0UHJpdmF0ZUF0dHJpYnV0ZXMsXG4gIGdldFRpbWVzdGFtcHNBdHRyaWJ1dGVzLFxuICBpc1ByaXZhdGVBdHRyaWJ1dGUsXG4gIGdldE5vbldyaXRhYmxlQXR0cmlidXRlcyxcbiAgZ2V0V3JpdGFibGVBdHRyaWJ1dGVzLFxuICBnZXROb25WaXNpYmxlQXR0cmlidXRlcyxcbiAgZ2V0VmlzaWJsZUF0dHJpYnV0ZXMsXG4gIGhhc0RyYWZ0QW5kUHVibGlzaCxcbiAgaXNEcmFmdCxcbiAgaXNTaW5nbGVUeXBlLFxuICBpc0NvbGxlY3Rpb25UeXBlLFxuICBpc0tpbmQsXG59ID0gcmVxdWlyZSgnLi4vY29udGVudC10eXBlcy51dGlsJyk7XG5jb25zdCBfID0gcmVxdWlyZSgnbG9kYXNoJyk7XG5cbmRlc2NyaWJlKCdDb250ZW50IHR5cGVzIHV0aWwnLCAoKSA9PiB7XG4gIHRlc3QoJ1Nob3VsZCBpcyBzY2FsYXIgYXR0cmlidXRlJywgKCkgPT4ge1xuICAgIGNvbnN0IGF0dHJpYnV0ZSA9IHtcbiAgICAgIHR5cGU6ICd0ZXN0JyxcbiAgICB9O1xuXG4gICAgZXhwZWN0KGlzU2NhbGFyQXR0cmlidXRlKGF0dHJpYnV0ZSkpLnRvQmUodHJ1ZSk7XG4gIH0pO1xuXG4gIHRlc3QoJ1Nob3VsZCBpcyBub3Qgc2NhbGFyIGF0dHJpYnV0ZScsICgpID0+IHtcbiAgICBjb25zdCBhdHRyaWJ1dGUgPSB7XG4gICAgICBjb2xsZWN0aW9uOiBqZXN0LmZuKCksXG4gICAgICBtb2RlbDogamVzdC5mbigpLFxuICAgICAgdHlwZTogJ2NvbXBvbmVudCcsXG4gICAgfTtcbiAgICBleHBlY3QoaXNTY2FsYXJBdHRyaWJ1dGUoYXR0cmlidXRlKSkudG9CZShmYWxzZSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdNZWRpYSBhdHRyaWJ1dGUnLCAoKSA9PiB7XG4gICAgdGVzdCgnU2hvdWxkIGlzIG1lZGlhIGF0dHJpYnV0ZSB3aGVuIGNvbGxlY3Rpb24gaXMgZmlsZScsICgpID0+IHtcbiAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IHtcbiAgICAgICAgY29sbGVjdGlvbjogJ2ZpbGUnLFxuICAgICAgICBwbHVnaW46ICd1cGxvYWQnLFxuICAgICAgfTtcbiAgICAgIGV4cGVjdChpc01lZGlhQXR0cmlidXRlKGF0dHJpYnV0ZSkpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ1Nob3VsZCBpcyBtZWRpYSBhdHRyaWJ1dGUgd2hlbiBtb2RlbCBpcyBmaWxlJywgKCkgPT4ge1xuICAgICAgY29uc3QgYXR0cmlidXRlID0ge1xuICAgICAgICBtb2RlbDogJ2ZpbGUnLFxuICAgICAgICBwbHVnaW46ICd1cGxvYWQnLFxuICAgICAgfTtcbiAgICAgIGV4cGVjdChpc01lZGlhQXR0cmlidXRlKGF0dHJpYnV0ZSkpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ1Nob3VsZCBpcyBub3QgbWVkaWEgYXR0cmlidXRlJywgKCkgPT4ge1xuICAgICAgY29uc3QgYXR0cmlidXRlID0ge1xuICAgICAgICBtb2RlbDogJ3RleHQnLFxuICAgICAgICBwbHVnaW46ICd1cGxvYWQnLFxuICAgICAgfTtcbiAgICAgIGV4cGVjdChpc01lZGlhQXR0cmlidXRlKGF0dHJpYnV0ZSkpLnRvQmVGYWxzeSgpO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdTaG91bGQgZ2V0IHByaXZhdGUgYXR0cmlidXRlcycsICgpID0+IHtcbiAgICBjb25zdCBtb2RlbCA9IHtcbiAgICAgIGF0dHJpYnV0ZXM6IHsgcGFzc3dvcmQ6IHsgcHJpdmF0ZTogdHJ1ZSB9IH0sXG4gICAgICBvcHRpb25zOiB7IHByaXZhdGVBdHRyaWJ1dGVzOiBbXSB9LFxuICAgIH07XG4gICAgY29uc3QgY29uZmlnID0ge1xuICAgICAgYXBpOiB7XG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIHByaXZhdGVBdHRyaWJ1dGVzOiBbXSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfTtcblxuICAgIGdsb2JhbC5zZ0FwcCA9IHtcbiAgICAgIGNvbmZpZzoge1xuICAgICAgICAuLi5jb25maWcsXG5cbiAgICAgICAgZ2V0KHBhdGgsIGRlZmF1bHRWYWx1ZSkge1xuICAgICAgICAgIHJldHVybiBfLmdldChjb25maWcsIHBhdGgsIGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0KHBhdGgsIHZhbCkge1xuICAgICAgICAgIF8uc2V0KGNvbmZpZywgcGF0aCwgdmFsKTtcblxuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuXG4gICAgICAgIGhhcyhwYXRoKSB7XG4gICAgICAgICAgcmV0dXJuIF8uaGFzKGNvbmZpZywgcGF0aCk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH07XG4gICAgY29uc3QgcmVzcCA9IGdldFByaXZhdGVBdHRyaWJ1dGVzKG1vZGVsKTtcbiAgICBleHBlY3QocmVzcCkudG9FcXVhbChbJ3Bhc3N3b3JkJ10pO1xuICB9KTtcblxuICB0ZXN0KCdTaG91bGQgZ2V0IHRpbWVzdGFtcHMgYXR0cmlidXRlcycsICgpID0+IHtcbiAgICBleHBlY3QoZ2V0VGltZXN0YW1wc0F0dHJpYnV0ZXMoKSkudG9FcXVhbCh7fSk7XG4gICAgZXhwZWN0KFxuICAgICAgZ2V0VGltZXN0YW1wc0F0dHJpYnV0ZXMoe1xuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgdGltZXN0YW1wczoge30sXG4gICAgICAgIH0sXG4gICAgICB9KVxuICAgICkudG9FcXVhbCh7fSk7XG4gICAgZXhwZWN0KFxuICAgICAgZ2V0VGltZXN0YW1wc0F0dHJpYnV0ZXMoe1xuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgdGltZXN0YW1wczogWyd0ZXN0J10sXG4gICAgICAgIH0sXG4gICAgICB9KVxuICAgICkudG9FcXVhbCh7IHRlc3Q6IHsgdHlwZTogJ3RpbWVzdGFtcCcgfSB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0lzIFByaXZhdGUgQXR0cmlidXRlJywgKCkgPT4ge1xuICAgIHRlc3QoJ1Nob3VsZCBpcyBwcml2YXRlIGF0dHJpYnV0ZScsICgpID0+IHtcbiAgICAgIGV4cGVjdChcbiAgICAgICAgaXNQcml2YXRlQXR0cmlidXRlKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHByaXZhdGVBdHRyaWJ1dGVzOiBbJ2F0dCddLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgJ2F0dCdcbiAgICAgICAgKVxuICAgICAgKS50b0VxdWFsKHRydWUpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnU2hvdWxkIGlzIG5vdCBwcml2YXRlIGF0dHJpYnV0ZSB3aGVuIG1vZGVsIGlzIGVtcHR5JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGlzUHJpdmF0ZUF0dHJpYnV0ZSgpKS50b0JlRmFsc3koKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdCgnU2hvdWxkIGdldCBub24gd3JpdGFibGUgYXR0cmlidXRlcycsICgpID0+IHtcbiAgICBleHBlY3QoZ2V0Tm9uV3JpdGFibGVBdHRyaWJ1dGVzKCkpLnRvRXF1YWwoW1xuICAgICAgJ2lkJyxcbiAgICAgICdjcmVhdGVkX2J5JyxcbiAgICAgICd1cGRhdGVkX2J5JyxcbiAgICAgIHVuZGVmaW5lZCxcbiAgICBdKTtcbiAgICBleHBlY3QoXG4gICAgICBnZXROb25Xcml0YWJsZUF0dHJpYnV0ZXMoe1xuICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgdGVzdDoge1xuICAgICAgICAgICAgd3JpdGFibGU6IGZhbHNlLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGVzdDE6IHtcbiAgICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KVxuICAgICkudG9FcXVhbChbJ2lkJywgJ2NyZWF0ZWRfYnknLCAndXBkYXRlZF9ieScsIHVuZGVmaW5lZCwgJ3Rlc3QnXSk7XG4gIH0pO1xuXG4gIHRlc3QoJ1Nob3VsZCBnZXQgd3JpdGFibGUgYXR0cmlidXRlcycsICgpID0+IHtcbiAgICBleHBlY3QoXG4gICAgICBnZXRXcml0YWJsZUF0dHJpYnV0ZXMoe1xuICAgICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgICAgdGVzdDoge1xuICAgICAgICAgICAgd3JpdGFibGU6IGZhbHNlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KVxuICAgICkudG9FcXVhbChbXSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdOb24gdmlzaWJsZSBhdHRyaWJ1dGVzJywgKCkgPT4ge1xuICAgIHRlc3QoJ1Nob3VsZCBnZXQgbm9uIHZpc2libGUgYXR0cmlidXRlcycsICgpID0+IHtcbiAgICAgIGV4cGVjdChcbiAgICAgICAgZ2V0Tm9uVmlzaWJsZUF0dHJpYnV0ZXMoe1xuICAgICAgICAgIGF0dHJpYnV0ZXM6IHsgdGVzdDogeyB3cml0YWJsZTogZmFsc2UgfSB9LFxuICAgICAgICAgIHByaW1hcnk6ICdhYmMnLFxuICAgICAgICB9KVxuICAgICAgKS50b0VxdWFsKFt1bmRlZmluZWQsICdpZCcsICdjcmVhdGVkX2J5JywgJ3VwZGF0ZWRfYnknLCAncHVibGlzaGVkX2F0J10pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVmlzaWJsZSBhdHRyaWJ1dGVzJywgKCkgPT4ge1xuICAgIHRlc3QoJ1Nob3VsZCBnZXQgdmlzaWJsZSBhdHRyaWJ1dGVzJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KFxuICAgICAgICBnZXRWaXNpYmxlQXR0cmlidXRlcyh7XG4gICAgICAgICAgYXR0cmlidXRlczogeyB0ZXN0OiB7IHdyaXRhYmxlOiBmYWxzZSB9IH0sXG4gICAgICAgICAgcHJpbWFyeTogJ2FiYycsXG4gICAgICAgIH0pXG4gICAgICApLnRvRXF1YWwoWyd0ZXN0J10pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRHJhZnQgYW5kIHB1Ymxpc2gnLCAoKSA9PiB7XG4gICAgdGVzdCgnU2hvdWxkIGhhcyBkcmFmdCBhbmQgcHVibGlzaCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChcbiAgICAgICAgaGFzRHJhZnRBbmRQdWJsaXNoKHsgb3B0aW9uczogeyBkcmFmdEFuZFB1Ymxpc2g6IHRydWUgfSB9KVxuICAgICAgKS50b0VxdWFsKHRydWUpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnU2hvdWxkIGhhcyBub3QgZHJhZnQgYW5kIHB1Ymxpc2gnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoXG4gICAgICAgIGhhc0RyYWZ0QW5kUHVibGlzaCh7IG9wdGlvbnM6IHsgZHJhZnRBbmRQdWJsaXNoOiBmYWxzZSB9IH0pXG4gICAgICApLnRvRXF1YWwoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRHJhZnQnLCAoKSA9PiB7XG4gICAgdGVzdCgnU2hvdWxkIGlzIGRyYWZ0JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KFxuICAgICAgICBpc0RyYWZ0KHsgcHVibGlzaGVkX2F0OiBudWxsIH0sIHsgb3B0aW9uczogeyBkcmFmdEFuZFB1Ymxpc2g6IHRydWUgfSB9KVxuICAgICAgKS50b0VxdWFsKHRydWUpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnU2hvdWxkIGlzIG5vdCBkcmFmdCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChcbiAgICAgICAgaXNEcmFmdCh7IHB1Ymxpc2hlZF9hdDogbnVsbCB9LCB7IG9wdGlvbnM6IHsgZHJhZnRBbmRQdWJsaXNoOiBmYWxzZSB9IH0pXG4gICAgICApLnRvRXF1YWwoZmFsc2UpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU2luZ2xlIHR5cGUnLCAoKSA9PiB7XG4gICAgdGVzdCgnU2hvdWxkIGlzIHNpbmdsZSB0eXBlJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGlzU2luZ2xlVHlwZSh7IGtpbmQ6ICdzaW5nbGVUeXBlJyB9KSkudG9CZVRydXRoeSgpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnU2hvdWxkIGlzIG5vdCBzaW5nbGUgdHlwZScsICgpID0+IHtcbiAgICAgIGV4cGVjdChpc1NpbmdsZVR5cGUoeyBraW5kOiAndGVzdCcgfSkpLnRvQmVGYWxzeSgpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnU2hvdWxkIGlzIG5vdCBzaW5nbGUgdHlwZSB3aXRoIGRlZmF1bHQga2luZCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChpc1NpbmdsZVR5cGUoe30pKS50b0JlRmFsc3koKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NvbGxlY3Rpb24gdHlwZScsICgpID0+IHtcbiAgICB0ZXN0KCdTaG91bGQgaXMgY29sbGVjdGlvbiB0eXBlJywgKCkgPT4ge1xuICAgICAgZXhwZWN0KGlzQ29sbGVjdGlvblR5cGUoeyBraW5kOiAnY29sbGVjdGlvblR5cGUnIH0pKS50b0JlVHJ1dGh5KCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdTaG91bGQgaXMgbm90IGNvbGxlY3Rpb24gdHlwZScsICgpID0+IHtcbiAgICAgIGV4cGVjdChpc0NvbGxlY3Rpb25UeXBlKHsga2luZDogJ3Rlc3QnIH0pKS50b0JlRmFsc3koKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ1Nob3VsZCBpcyBjb2xsZWN0aW9uIHR5cGUgd2l0aCBkZWZhdWx0IGtpbmQnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoaXNDb2xsZWN0aW9uVHlwZSh7fSkpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0tpbmQnLCAoKSA9PiB7XG4gICAgdGVzdCgnU2hvdWxkIGlzIGtpbmQnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoaXNLaW5kKCd0ZXN0JykoeyBraW5kOiAndGVzdCcgfSkpLnRvRXF1YWwodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdTaG91bGQgaXMgbm90IGtpbmQnLCAoKSA9PiB7XG4gICAgICBleHBlY3QoaXNLaW5kKCd0ZXN0JykoeyBraW5kOiAndGVzdDEnIH0pKS50b0VxdWFsKGZhbHNlKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdfQ==
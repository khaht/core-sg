7cbb68f444410b38b240f303325f4e93
const sgApp = require('../App');

describe('Init App', () => {
  const OLD_ENV = process.env;
  beforeEach(() => {
    jest.resetModules();
    process.env = { ...OLD_ENV
    };
  });
  test('Should initial App', () => {
    const app = sgApp();
    expect(Object.keys(app)).toEqual(['app', 'router', 'server', 'log', 'dir', 'admin', 'plugins', 'config', 'isLoaded', 'fs', 'eventHub']);
  });
  describe('InitServer error', () => {
    test('Should initServer error', async () => {
      const app = sgApp();
      app.log.error = jest.fn(() => 'error');

      app.server._events.error('error');

      expect(app.log.error).toHaveBeenCalledTimes(1);
    });
    test('Should initServer error when the port is already used by another application.', async () => {
      const app = sgApp();
      app.stopWithError = jest.fn();

      app.server._events.error({
        code: 'EADDRINUSE',
        port: 4000
      });

      expect(app.stopWithError).toHaveBeenCalledTimes(1);
    });
    test('Should initServer, connect and destroy server.', async () => {
      const cb = jest.fn();
      const app = sgApp();
      const conn = {
        remoteAddress: 'localhost',
        remotePort: 4000,
        on: jest.fn(),
        destroy: jest.fn()
      };
      app.server.close = jest.fn();
      app.initServer();

      app.server._events.connection[1](conn);

      app.server.destroy(cb);
      expect(conn.destroy).toHaveBeenCalledTimes(1);
    });
  });
  describe('Listen behaviors to the server', () => {
    test('should call listen function, listen on port and host', () => {
      const app = sgApp();
      app.server.listen = jest.fn();
      app.listen();
      expect(app.server.listen).toHaveBeenCalledTimes(1);
    });
    test('should call listen function, listen on socket', () => {
      const app = sgApp();
      app.server.listen = jest.fn();
      app.config.get = jest.fn(key => {
        if (key == 'server.socket') return 'server.socket';
      });
      app.listen();
      expect(app.server.listen).toHaveBeenCalledTimes(1);
      expect(app.config.get).toHaveBeenCalledTimes(1);
    });
    test('should call listenErrHandler', () => {
      const cb = jest.fn();
      const app = sgApp();
      app.logStartupMessage = jest.fn();
      app.server.listen = jest.fn((listen, callback) => {
        if (listen == 'error') callback();
      });
      app.config.get = jest.fn(key => {
        if (key == 'server.socket') return 'error';
      });
      app.listen(cb);
      expect(cb).toHaveBeenCalledTimes(1);
      expect(app.server.listen).toHaveBeenCalledTimes(1);
      expect(app.config.get).toHaveBeenCalledTimes(1);
      expect(app.logStartupMessage).toHaveBeenCalledTimes(1);
    });
    test('should call listenErrHandler with a error', () => {
      const app = sgApp();
      app.stopWithError = jest.fn();
      app.server.listen = jest.fn((listen, callback) => {
        if (listen == 'error') callback('error');
      });
      app.config.get = jest.fn(key => {
        if (key == 'server.socket') return 'error';
      });
      app.listen();
      expect(app.server.listen).toHaveBeenCalledTimes(1);
      expect(app.config.get).toHaveBeenCalledTimes(1);
      expect(app.stopWithError).toHaveBeenCalledTimes(1);
    });
    test('should call listenErrHandler with HIDE_STARTUP_MESSAGE=true', () => {
      process.env.HIDE_STARTUP_MESSAGE = true;
      const app = sgApp();
      app.server.listen = jest.fn((listen, callback) => {
        if (listen == 'error') callback();
      });
      app.config.get = jest.fn(key => {
        if (key == 'server.socket') return 'error';
      });
      app.listen();
      expect(app.server.listen).toHaveBeenCalledTimes(1);
      expect(app.config.get).toHaveBeenCalledTimes(1);
    });
    test('should call listenErrHandler with HIDE_STARTUP_MESSAGE=false', () => {
      process.env.HIDE_STARTUP_MESSAGE = false;
      const app = sgApp();
      app.logStartupMessage = jest.fn();
      app.server.listen = jest.fn((listen, callback) => {
        if (listen == 'error') callback();
      });
      app.config.get = jest.fn(key => {
        if (key == 'server.socket') return 'error';
      });
      app.listen();
      expect(app.server.listen).toHaveBeenCalledTimes(1);
      expect(app.config.get).toHaveBeenCalledTimes(1);
      expect(app.logStartupMessage).toHaveBeenCalledTimes(1);
    });
  });
  describe('Server connection', () => {
    test('should connection to server', () => {
      const app = sgApp();
      const conn = {
        remoteAddress: 'localhost',
        remotePort: 4000,
        on: jest.fn((type, callback) => {
          if (type == 'close') {
            callback();
          }
        })
      };

      app.server._events.connection[1](conn);

      expect(conn.on).toHaveBeenCalledTimes(1);
    });
  });
  describe('Stop WithError', () => {
    test('Should call stopWithError function with customMessage', async () => {
      const app = sgApp();
      app.stop = jest.fn();
      app.log.error = jest.fn();
      app.stopWithError('error', 'customMessage');
      expect(app.stop).toHaveBeenCalledTimes(1);
      expect(app.log.error).toHaveBeenCalledTimes(2);
    });
    test('Should call stopWithError function with does not have customMessage', async () => {
      const app = sgApp();
      app.stop = jest.fn();
      app.log.error = jest.fn();
      app.stopWithError('error');
      expect(app.stop).toHaveBeenCalledTimes(1);
      expect(app.log.error).toHaveBeenCalledTimes(1);
    });
  });
  describe('Stop app', () => {
    test('Should call stop function', async () => {
      const app = sgApp();
      process.exit = jest.fn();
      app.stop();
      expect(process.exit).toHaveBeenCalledTimes(1);
    });
    test('Should call stop function in case does not have server destroy function', async () => {
      const app = sgApp();
      delete app.server.destroy;
      process.exit = jest.fn();
      app.stop();
      expect(process.exit).toHaveBeenCalledTimes(1);
    });
  });
  describe('Start app', () => {
    test('Should call start function', async () => {
      const app = sgApp();
      const cb = jest.fn();
      app.load = jest.fn();
      app.listen = jest.fn();
      await app.start(cb);
      expect(app.load).toHaveBeenCalledTimes(1);
      expect(app.listen).toHaveBeenCalledTimes(1);
      expect(app.listen).toHaveBeenCalledWith(cb);
    });
    test('Should call start function and not call load', async () => {
      const app = sgApp();
      const cb = jest.fn();
      app.listen = jest.fn();
      app.isLoaded = true;
      await app.start(cb);
      expect(app.listen).toHaveBeenCalledTimes(1);
      expect(app.listen).toHaveBeenCalledWith(cb);
    });
    test('Should call start function and throw error', async () => {
      const app = sgApp();
      const cb = jest.fn();
      app.load = jest.fn();
      app.listen = jest.fn(() => {
        throw new Error('error');
      });
      app.stopWithError = jest.fn();
      await app.start(cb);
      expect(app.load).toHaveBeenCalledTimes(1);
      expect(app.listen).toHaveBeenCalledTimes(1);
      expect(app.stopWithError).toHaveBeenCalledTimes(1);
      expect(app.listen).toHaveBeenCalledWith(cb);
    });
  });
  describe('Destroy app', () => {
    test('Should call destroy function', async () => {
      const app = sgApp();
      app.db = {
        destroy: jest.fn()
      };
      app.plugins = {
        plugin1: {
          destroy: jest.fn()
        },
        plugin2: {}
      };
      app.eventHub.removeAllListeners = jest.fn();
      app.admin.destroy = jest.fn();
      await app.destroy();
      expect(app.admin.destroy).toHaveBeenCalledTimes(1);
      expect(app.db.destroy).toHaveBeenCalledTimes(1);
      expect(app.plugins.plugin1.destroy).toHaveBeenCalledTimes(1);
    });
    test('Should call destroy function in case else', async () => {
      const app = sgApp();
      app.plugins = {
        plugin1: {
          destroy: jest.fn()
        },
        plugin2: {}
      };
      app.eventHub.removeAllListeners = jest.fn();
      delete app.server.destroy;
      delete app.admin;
      await app.destroy();
      expect(app.plugins.plugin1.destroy).toHaveBeenCalledTimes(1);
    });
  });
  describe('Load App', () => {
    test('Should call load function', async () => {
      const app = sgApp();
      app.app = {
        use: jest.fn()
      };
      await app.load();
      expect(app.app.use).toHaveBeenCalled();
    });
    test('Should call load function with mode dev', async () => {
      process.env.NODE_ENV = 'development';
      const app = sgApp();
      app.app = {
        use: jest.fn()
      };
      await app.load();
      expect(app.app.use).toHaveBeenCalled();
    });
  });
  test('should call health function and go to next function', async () => {
    const app = sgApp();
    const req = {};
    const res = {
      status: jest.fn()
    };
    const next = jest.fn();
    await app.health(req, res, next);
    expect(next).toHaveBeenCalledTimes(1);
  });
  test('should call health function and return status 204', async () => {
    const app = sgApp();
    const req = {
      url: '/_health',
      method: 'HEAD'
    };
    const res = {
      status: jest.fn().mockImplementation(status => status)
    };
    const next = jest.fn();
    const resp = await app.health(req, res, next);
    expect(resp).toBe(204);
    expect(res.status).toHaveBeenCalledTimes(1);
  });
  test('should call serverError function and return status 500', async () => {
    const app = sgApp();
    const err = {};
    const req = {};
    const res = {
      status: jest.fn().mockImplementation(status => ({
        send: jest.fn().mockImplementation(message => message)
      }))
    };
    app.serverError(err, req, res);
    expect(res.status).toHaveBeenCalledTimes(1);
  });
  test('Should call logStartupMessage function', async () => {
    const app = sgApp();
    app.logStartupMessage();
  });
  describe('Run Bootstrap Functions', () => {
    test('should execBootstrap return undefined', async () => {
      const app = sgApp();
      app.plugins = {
        email: {
          config: {
            functions: {
              bootstrap: null
            }
          }
        }
      };
      await app.runBootstrapFunctions();
    });
    test('should run Bootstrap function is fail', async () => {
      const app = sgApp();
      app.stop = jest.fn();
      app.plugins = {
        email: {
          config: {
            functions: {
              bootstrap: 'bootstrap'
            }
          }
        }
      };
      await app.runBootstrapFunctions();
      expect(app.stop).toHaveBeenCalledTimes(1);
    });
  });
  test('should call freeze function', () => {
    const app = sgApp();
    app.freeze();
  });
  describe('Call database', () => {
    const app = sgApp();
    test('should return get model', () => {
      app.db = {
        getModel: jest.fn(() => 'model')
      };
      expect(app.getModel()).toBe('model');
      expect(app.db.getModel).toHaveBeenCalledTimes(1);
    });
    test('should return query', () => {
      app.db = {
        query: jest.fn(() => 'query')
      };
      expect(app.query()).toBe('query');
      expect(app.db.query).toHaveBeenCalledTimes(1);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFwcC50ZXN0LmpzIl0sIm5hbWVzIjpbInNnQXBwIiwicmVxdWlyZSIsImRlc2NyaWJlIiwiT0xEX0VOViIsInByb2Nlc3MiLCJlbnYiLCJiZWZvcmVFYWNoIiwiamVzdCIsInJlc2V0TW9kdWxlcyIsInRlc3QiLCJhcHAiLCJleHBlY3QiLCJPYmplY3QiLCJrZXlzIiwidG9FcXVhbCIsImxvZyIsImVycm9yIiwiZm4iLCJzZXJ2ZXIiLCJfZXZlbnRzIiwidG9IYXZlQmVlbkNhbGxlZFRpbWVzIiwic3RvcFdpdGhFcnJvciIsImNvZGUiLCJwb3J0IiwiY2IiLCJjb25uIiwicmVtb3RlQWRkcmVzcyIsInJlbW90ZVBvcnQiLCJvbiIsImRlc3Ryb3kiLCJjbG9zZSIsImluaXRTZXJ2ZXIiLCJjb25uZWN0aW9uIiwibGlzdGVuIiwiY29uZmlnIiwiZ2V0Iiwia2V5IiwibG9nU3RhcnR1cE1lc3NhZ2UiLCJjYWxsYmFjayIsIkhJREVfU1RBUlRVUF9NRVNTQUdFIiwidHlwZSIsInN0b3AiLCJleGl0IiwibG9hZCIsInN0YXJ0IiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJpc0xvYWRlZCIsIkVycm9yIiwiZGIiLCJwbHVnaW5zIiwicGx1Z2luMSIsInBsdWdpbjIiLCJldmVudEh1YiIsInJlbW92ZUFsbExpc3RlbmVycyIsImFkbWluIiwidXNlIiwidG9IYXZlQmVlbkNhbGxlZCIsIk5PREVfRU5WIiwicmVxIiwicmVzIiwic3RhdHVzIiwibmV4dCIsImhlYWx0aCIsInVybCIsIm1ldGhvZCIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsInJlc3AiLCJ0b0JlIiwiZXJyIiwic2VuZCIsIm1lc3NhZ2UiLCJzZXJ2ZXJFcnJvciIsImVtYWlsIiwiZnVuY3Rpb25zIiwiYm9vdHN0cmFwIiwicnVuQm9vdHN0cmFwRnVuY3Rpb25zIiwiZnJlZXplIiwiZ2V0TW9kZWwiLCJxdWVyeSJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsUUFBRCxDQUFyQjs7QUFFQUMsUUFBUSxDQUFDLFVBQUQsRUFBYSxNQUFNO0FBQ3pCLFFBQU1DLE9BQU8sR0FBR0MsT0FBTyxDQUFDQyxHQUF4QjtBQUVBQyxFQUFBQSxVQUFVLENBQUMsTUFBTTtBQUNmQyxJQUFBQSxJQUFJLENBQUNDLFlBQUw7QUFDQUosSUFBQUEsT0FBTyxDQUFDQyxHQUFSLEdBQWMsRUFBRSxHQUFHRjtBQUFMLEtBQWQ7QUFDRCxHQUhTLENBQVY7QUFLQU0sRUFBQUEsSUFBSSxDQUFDLG9CQUFELEVBQXVCLE1BQU07QUFDL0IsVUFBTUMsR0FBRyxHQUFHVixLQUFLLEVBQWpCO0FBQ0FXLElBQUFBLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDQyxJQUFQLENBQVlILEdBQVosQ0FBRCxDQUFOLENBQXlCSSxPQUF6QixDQUFpQyxDQUMvQixLQUQrQixFQUUvQixRQUYrQixFQUcvQixRQUgrQixFQUkvQixLQUorQixFQUsvQixLQUwrQixFQU0vQixPQU4rQixFQU8vQixTQVArQixFQVEvQixRQVIrQixFQVMvQixVQVQrQixFQVUvQixJQVYrQixFQVcvQixVQVgrQixDQUFqQztBQWFELEdBZkcsQ0FBSjtBQWlCQVosRUFBQUEsUUFBUSxDQUFDLGtCQUFELEVBQXFCLE1BQU07QUFDakNPLElBQUFBLElBQUksQ0FBQyx5QkFBRCxFQUE0QixZQUFZO0FBQzFDLFlBQU1DLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBVSxNQUFBQSxHQUFHLENBQUNLLEdBQUosQ0FBUUMsS0FBUixHQUFnQlQsSUFBSSxDQUFDVSxFQUFMLENBQVEsTUFBTSxPQUFkLENBQWhCOztBQUNBUCxNQUFBQSxHQUFHLENBQUNRLE1BQUosQ0FBV0MsT0FBWCxDQUFtQkgsS0FBbkIsQ0FBeUIsT0FBekI7O0FBQ0FMLE1BQUFBLE1BQU0sQ0FBQ0QsR0FBRyxDQUFDSyxHQUFKLENBQVFDLEtBQVQsQ0FBTixDQUFzQkkscUJBQXRCLENBQTRDLENBQTVDO0FBQ0QsS0FMRyxDQUFKO0FBT0FYLElBQUFBLElBQUksQ0FBQywrRUFBRCxFQUFrRixZQUFZO0FBQ2hHLFlBQU1DLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBVSxNQUFBQSxHQUFHLENBQUNXLGFBQUosR0FBb0JkLElBQUksQ0FBQ1UsRUFBTCxFQUFwQjs7QUFDQVAsTUFBQUEsR0FBRyxDQUFDUSxNQUFKLENBQVdDLE9BQVgsQ0FBbUJILEtBQW5CLENBQXlCO0FBQUVNLFFBQUFBLElBQUksRUFBRSxZQUFSO0FBQXNCQyxRQUFBQSxJQUFJLEVBQUU7QUFBNUIsT0FBekI7O0FBQ0FaLE1BQUFBLE1BQU0sQ0FBQ0QsR0FBRyxDQUFDVyxhQUFMLENBQU4sQ0FBMEJELHFCQUExQixDQUFnRCxDQUFoRDtBQUNELEtBTEcsQ0FBSjtBQU9BWCxJQUFBQSxJQUFJLENBQUMsZ0RBQUQsRUFBbUQsWUFBWTtBQUNqRSxZQUFNZSxFQUFFLEdBQUdqQixJQUFJLENBQUNVLEVBQUwsRUFBWDtBQUNBLFlBQU1QLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBLFlBQU15QixJQUFJLEdBQUc7QUFDWEMsUUFBQUEsYUFBYSxFQUFFLFdBREo7QUFFWEMsUUFBQUEsVUFBVSxFQUFFLElBRkQ7QUFHWEMsUUFBQUEsRUFBRSxFQUFFckIsSUFBSSxDQUFDVSxFQUFMLEVBSE87QUFJWFksUUFBQUEsT0FBTyxFQUFFdEIsSUFBSSxDQUFDVSxFQUFMO0FBSkUsT0FBYjtBQU1BUCxNQUFBQSxHQUFHLENBQUNRLE1BQUosQ0FBV1ksS0FBWCxHQUFtQnZCLElBQUksQ0FBQ1UsRUFBTCxFQUFuQjtBQUVBUCxNQUFBQSxHQUFHLENBQUNxQixVQUFKOztBQUNBckIsTUFBQUEsR0FBRyxDQUFDUSxNQUFKLENBQVdDLE9BQVgsQ0FBbUJhLFVBQW5CLENBQThCLENBQTlCLEVBQWlDUCxJQUFqQzs7QUFDQWYsTUFBQUEsR0FBRyxDQUFDUSxNQUFKLENBQVdXLE9BQVgsQ0FBbUJMLEVBQW5CO0FBQ0FiLE1BQUFBLE1BQU0sQ0FBQ2MsSUFBSSxDQUFDSSxPQUFOLENBQU4sQ0FBcUJULHFCQUFyQixDQUEyQyxDQUEzQztBQUNELEtBZkcsQ0FBSjtBQWdCRCxHQS9CTyxDQUFSO0FBaUNBbEIsRUFBQUEsUUFBUSxDQUFDLGdDQUFELEVBQW1DLE1BQU07QUFDL0NPLElBQUFBLElBQUksQ0FBQyxzREFBRCxFQUF5RCxNQUFNO0FBQ2pFLFlBQU1DLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBVSxNQUFBQSxHQUFHLENBQUNRLE1BQUosQ0FBV2UsTUFBWCxHQUFvQjFCLElBQUksQ0FBQ1UsRUFBTCxFQUFwQjtBQUNBUCxNQUFBQSxHQUFHLENBQUN1QixNQUFKO0FBQ0F0QixNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ1EsTUFBSixDQUFXZSxNQUFaLENBQU4sQ0FBMEJiLHFCQUExQixDQUFnRCxDQUFoRDtBQUNELEtBTEcsQ0FBSjtBQU9BWCxJQUFBQSxJQUFJLENBQUMsK0NBQUQsRUFBa0QsTUFBTTtBQUMxRCxZQUFNQyxHQUFHLEdBQUdWLEtBQUssRUFBakI7QUFDQVUsTUFBQUEsR0FBRyxDQUFDUSxNQUFKLENBQVdlLE1BQVgsR0FBb0IxQixJQUFJLENBQUNVLEVBQUwsRUFBcEI7QUFDQVAsTUFBQUEsR0FBRyxDQUFDd0IsTUFBSixDQUFXQyxHQUFYLEdBQWlCNUIsSUFBSSxDQUFDVSxFQUFMLENBQVNtQixHQUFELElBQVM7QUFDaEMsWUFBSUEsR0FBRyxJQUFJLGVBQVgsRUFBNEIsT0FBTyxlQUFQO0FBQzdCLE9BRmdCLENBQWpCO0FBR0ExQixNQUFBQSxHQUFHLENBQUN1QixNQUFKO0FBQ0F0QixNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ1EsTUFBSixDQUFXZSxNQUFaLENBQU4sQ0FBMEJiLHFCQUExQixDQUFnRCxDQUFoRDtBQUNBVCxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ3dCLE1BQUosQ0FBV0MsR0FBWixDQUFOLENBQXVCZixxQkFBdkIsQ0FBNkMsQ0FBN0M7QUFDRCxLQVRHLENBQUo7QUFXQVgsSUFBQUEsSUFBSSxDQUFDLDhCQUFELEVBQWlDLE1BQU07QUFDekMsWUFBTWUsRUFBRSxHQUFHakIsSUFBSSxDQUFDVSxFQUFMLEVBQVg7QUFDQSxZQUFNUCxHQUFHLEdBQUdWLEtBQUssRUFBakI7QUFDQVUsTUFBQUEsR0FBRyxDQUFDMkIsaUJBQUosR0FBd0I5QixJQUFJLENBQUNVLEVBQUwsRUFBeEI7QUFDQVAsTUFBQUEsR0FBRyxDQUFDUSxNQUFKLENBQVdlLE1BQVgsR0FBb0IxQixJQUFJLENBQUNVLEVBQUwsQ0FBUSxDQUFDZ0IsTUFBRCxFQUFTSyxRQUFULEtBQXNCO0FBQ2hELFlBQUlMLE1BQU0sSUFBSSxPQUFkLEVBQXVCSyxRQUFRO0FBQ2hDLE9BRm1CLENBQXBCO0FBR0E1QixNQUFBQSxHQUFHLENBQUN3QixNQUFKLENBQVdDLEdBQVgsR0FBaUI1QixJQUFJLENBQUNVLEVBQUwsQ0FBU21CLEdBQUQsSUFBUztBQUNoQyxZQUFJQSxHQUFHLElBQUksZUFBWCxFQUE0QixPQUFPLE9BQVA7QUFDN0IsT0FGZ0IsQ0FBakI7QUFHQTFCLE1BQUFBLEdBQUcsQ0FBQ3VCLE1BQUosQ0FBV1QsRUFBWDtBQUNBYixNQUFBQSxNQUFNLENBQUNhLEVBQUQsQ0FBTixDQUFXSixxQkFBWCxDQUFpQyxDQUFqQztBQUNBVCxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ1EsTUFBSixDQUFXZSxNQUFaLENBQU4sQ0FBMEJiLHFCQUExQixDQUFnRCxDQUFoRDtBQUNBVCxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ3dCLE1BQUosQ0FBV0MsR0FBWixDQUFOLENBQXVCZixxQkFBdkIsQ0FBNkMsQ0FBN0M7QUFDQVQsTUFBQUEsTUFBTSxDQUFDRCxHQUFHLENBQUMyQixpQkFBTCxDQUFOLENBQThCakIscUJBQTlCLENBQW9ELENBQXBEO0FBQ0QsS0FmRyxDQUFKO0FBaUJBWCxJQUFBQSxJQUFJLENBQUMsMkNBQUQsRUFBOEMsTUFBTTtBQUN0RCxZQUFNQyxHQUFHLEdBQUdWLEtBQUssRUFBakI7QUFDQVUsTUFBQUEsR0FBRyxDQUFDVyxhQUFKLEdBQW9CZCxJQUFJLENBQUNVLEVBQUwsRUFBcEI7QUFDQVAsTUFBQUEsR0FBRyxDQUFDUSxNQUFKLENBQVdlLE1BQVgsR0FBb0IxQixJQUFJLENBQUNVLEVBQUwsQ0FBUSxDQUFDZ0IsTUFBRCxFQUFTSyxRQUFULEtBQXNCO0FBQ2hELFlBQUlMLE1BQU0sSUFBSSxPQUFkLEVBQXVCSyxRQUFRLENBQUMsT0FBRCxDQUFSO0FBQ3hCLE9BRm1CLENBQXBCO0FBR0E1QixNQUFBQSxHQUFHLENBQUN3QixNQUFKLENBQVdDLEdBQVgsR0FBaUI1QixJQUFJLENBQUNVLEVBQUwsQ0FBU21CLEdBQUQsSUFBUztBQUNoQyxZQUFJQSxHQUFHLElBQUksZUFBWCxFQUE0QixPQUFPLE9BQVA7QUFDN0IsT0FGZ0IsQ0FBakI7QUFHQTFCLE1BQUFBLEdBQUcsQ0FBQ3VCLE1BQUo7QUFDQXRCLE1BQUFBLE1BQU0sQ0FBQ0QsR0FBRyxDQUFDUSxNQUFKLENBQVdlLE1BQVosQ0FBTixDQUEwQmIscUJBQTFCLENBQWdELENBQWhEO0FBQ0FULE1BQUFBLE1BQU0sQ0FBQ0QsR0FBRyxDQUFDd0IsTUFBSixDQUFXQyxHQUFaLENBQU4sQ0FBdUJmLHFCQUF2QixDQUE2QyxDQUE3QztBQUNBVCxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ1csYUFBTCxDQUFOLENBQTBCRCxxQkFBMUIsQ0FBZ0QsQ0FBaEQ7QUFDRCxLQWJHLENBQUo7QUFlQVgsSUFBQUEsSUFBSSxDQUFDLDZEQUFELEVBQWdFLE1BQU07QUFDeEVMLE1BQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZa0Msb0JBQVosR0FBbUMsSUFBbkM7QUFDQSxZQUFNN0IsR0FBRyxHQUFHVixLQUFLLEVBQWpCO0FBQ0FVLE1BQUFBLEdBQUcsQ0FBQ1EsTUFBSixDQUFXZSxNQUFYLEdBQW9CMUIsSUFBSSxDQUFDVSxFQUFMLENBQVEsQ0FBQ2dCLE1BQUQsRUFBU0ssUUFBVCxLQUFzQjtBQUNoRCxZQUFJTCxNQUFNLElBQUksT0FBZCxFQUF1QkssUUFBUTtBQUNoQyxPQUZtQixDQUFwQjtBQUdBNUIsTUFBQUEsR0FBRyxDQUFDd0IsTUFBSixDQUFXQyxHQUFYLEdBQWlCNUIsSUFBSSxDQUFDVSxFQUFMLENBQVNtQixHQUFELElBQVM7QUFDaEMsWUFBSUEsR0FBRyxJQUFJLGVBQVgsRUFBNEIsT0FBTyxPQUFQO0FBQzdCLE9BRmdCLENBQWpCO0FBR0ExQixNQUFBQSxHQUFHLENBQUN1QixNQUFKO0FBQ0F0QixNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ1EsTUFBSixDQUFXZSxNQUFaLENBQU4sQ0FBMEJiLHFCQUExQixDQUFnRCxDQUFoRDtBQUNBVCxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ3dCLE1BQUosQ0FBV0MsR0FBWixDQUFOLENBQXVCZixxQkFBdkIsQ0FBNkMsQ0FBN0M7QUFDRCxLQVpHLENBQUo7QUFjQVgsSUFBQUEsSUFBSSxDQUFDLDhEQUFELEVBQWlFLE1BQU07QUFDekVMLE1BQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZa0Msb0JBQVosR0FBbUMsS0FBbkM7QUFDQSxZQUFNN0IsR0FBRyxHQUFHVixLQUFLLEVBQWpCO0FBQ0FVLE1BQUFBLEdBQUcsQ0FBQzJCLGlCQUFKLEdBQXdCOUIsSUFBSSxDQUFDVSxFQUFMLEVBQXhCO0FBQ0FQLE1BQUFBLEdBQUcsQ0FBQ1EsTUFBSixDQUFXZSxNQUFYLEdBQW9CMUIsSUFBSSxDQUFDVSxFQUFMLENBQVEsQ0FBQ2dCLE1BQUQsRUFBU0ssUUFBVCxLQUFzQjtBQUNoRCxZQUFJTCxNQUFNLElBQUksT0FBZCxFQUF1QkssUUFBUTtBQUNoQyxPQUZtQixDQUFwQjtBQUdBNUIsTUFBQUEsR0FBRyxDQUFDd0IsTUFBSixDQUFXQyxHQUFYLEdBQWlCNUIsSUFBSSxDQUFDVSxFQUFMLENBQVNtQixHQUFELElBQVM7QUFDaEMsWUFBSUEsR0FBRyxJQUFJLGVBQVgsRUFBNEIsT0FBTyxPQUFQO0FBQzdCLE9BRmdCLENBQWpCO0FBR0ExQixNQUFBQSxHQUFHLENBQUN1QixNQUFKO0FBQ0F0QixNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ1EsTUFBSixDQUFXZSxNQUFaLENBQU4sQ0FBMEJiLHFCQUExQixDQUFnRCxDQUFoRDtBQUNBVCxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ3dCLE1BQUosQ0FBV0MsR0FBWixDQUFOLENBQXVCZixxQkFBdkIsQ0FBNkMsQ0FBN0M7QUFDQVQsTUFBQUEsTUFBTSxDQUFDRCxHQUFHLENBQUMyQixpQkFBTCxDQUFOLENBQThCakIscUJBQTlCLENBQW9ELENBQXBEO0FBQ0QsS0FkRyxDQUFKO0FBZUQsR0FoRk8sQ0FBUjtBQWtGQWxCLEVBQUFBLFFBQVEsQ0FBQyxtQkFBRCxFQUFzQixNQUFNO0FBQ2xDTyxJQUFBQSxJQUFJLENBQUMsNkJBQUQsRUFBZ0MsTUFBTTtBQUN4QyxZQUFNQyxHQUFHLEdBQUdWLEtBQUssRUFBakI7QUFDQSxZQUFNeUIsSUFBSSxHQUFHO0FBQ1hDLFFBQUFBLGFBQWEsRUFBRSxXQURKO0FBRVhDLFFBQUFBLFVBQVUsRUFBRSxJQUZEO0FBR1hDLFFBQUFBLEVBQUUsRUFBRXJCLElBQUksQ0FBQ1UsRUFBTCxDQUFRLENBQUN1QixJQUFELEVBQU9GLFFBQVAsS0FBb0I7QUFDOUIsY0FBSUUsSUFBSSxJQUFJLE9BQVosRUFBcUI7QUFDbkJGLFlBQUFBLFFBQVE7QUFDVDtBQUNGLFNBSkc7QUFITyxPQUFiOztBQVNBNUIsTUFBQUEsR0FBRyxDQUFDUSxNQUFKLENBQVdDLE9BQVgsQ0FBbUJhLFVBQW5CLENBQThCLENBQTlCLEVBQWlDUCxJQUFqQzs7QUFDQWQsTUFBQUEsTUFBTSxDQUFDYyxJQUFJLENBQUNHLEVBQU4sQ0FBTixDQUFnQlIscUJBQWhCLENBQXNDLENBQXRDO0FBQ0QsS0FiRyxDQUFKO0FBY0QsR0FmTyxDQUFSO0FBaUJBbEIsRUFBQUEsUUFBUSxDQUFDLGdCQUFELEVBQW1CLE1BQU07QUFDL0JPLElBQUFBLElBQUksQ0FBQyx1REFBRCxFQUEwRCxZQUFZO0FBQ3hFLFlBQU1DLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBVSxNQUFBQSxHQUFHLENBQUMrQixJQUFKLEdBQVdsQyxJQUFJLENBQUNVLEVBQUwsRUFBWDtBQUNBUCxNQUFBQSxHQUFHLENBQUNLLEdBQUosQ0FBUUMsS0FBUixHQUFnQlQsSUFBSSxDQUFDVSxFQUFMLEVBQWhCO0FBQ0FQLE1BQUFBLEdBQUcsQ0FBQ1csYUFBSixDQUFrQixPQUFsQixFQUEyQixlQUEzQjtBQUNBVixNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQytCLElBQUwsQ0FBTixDQUFpQnJCLHFCQUFqQixDQUF1QyxDQUF2QztBQUNBVCxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ0ssR0FBSixDQUFRQyxLQUFULENBQU4sQ0FBc0JJLHFCQUF0QixDQUE0QyxDQUE1QztBQUNELEtBUEcsQ0FBSjtBQVNBWCxJQUFBQSxJQUFJLENBQUMscUVBQUQsRUFBd0UsWUFBWTtBQUN0RixZQUFNQyxHQUFHLEdBQUdWLEtBQUssRUFBakI7QUFDQVUsTUFBQUEsR0FBRyxDQUFDK0IsSUFBSixHQUFXbEMsSUFBSSxDQUFDVSxFQUFMLEVBQVg7QUFDQVAsTUFBQUEsR0FBRyxDQUFDSyxHQUFKLENBQVFDLEtBQVIsR0FBZ0JULElBQUksQ0FBQ1UsRUFBTCxFQUFoQjtBQUNBUCxNQUFBQSxHQUFHLENBQUNXLGFBQUosQ0FBa0IsT0FBbEI7QUFDQVYsTUFBQUEsTUFBTSxDQUFDRCxHQUFHLENBQUMrQixJQUFMLENBQU4sQ0FBaUJyQixxQkFBakIsQ0FBdUMsQ0FBdkM7QUFDQVQsTUFBQUEsTUFBTSxDQUFDRCxHQUFHLENBQUNLLEdBQUosQ0FBUUMsS0FBVCxDQUFOLENBQXNCSSxxQkFBdEIsQ0FBNEMsQ0FBNUM7QUFDRCxLQVBHLENBQUo7QUFRRCxHQWxCTyxDQUFSO0FBb0JBbEIsRUFBQUEsUUFBUSxDQUFDLFVBQUQsRUFBYSxNQUFNO0FBQ3pCTyxJQUFBQSxJQUFJLENBQUMsMkJBQUQsRUFBOEIsWUFBWTtBQUM1QyxZQUFNQyxHQUFHLEdBQUdWLEtBQUssRUFBakI7QUFDQUksTUFBQUEsT0FBTyxDQUFDc0MsSUFBUixHQUFlbkMsSUFBSSxDQUFDVSxFQUFMLEVBQWY7QUFDQVAsTUFBQUEsR0FBRyxDQUFDK0IsSUFBSjtBQUNBOUIsTUFBQUEsTUFBTSxDQUFDUCxPQUFPLENBQUNzQyxJQUFULENBQU4sQ0FBcUJ0QixxQkFBckIsQ0FBMkMsQ0FBM0M7QUFDRCxLQUxHLENBQUo7QUFPQVgsSUFBQUEsSUFBSSxDQUFDLHlFQUFELEVBQTRFLFlBQVk7QUFDMUYsWUFBTUMsR0FBRyxHQUFHVixLQUFLLEVBQWpCO0FBQ0EsYUFBT1UsR0FBRyxDQUFDUSxNQUFKLENBQVdXLE9BQWxCO0FBQ0F6QixNQUFBQSxPQUFPLENBQUNzQyxJQUFSLEdBQWVuQyxJQUFJLENBQUNVLEVBQUwsRUFBZjtBQUNBUCxNQUFBQSxHQUFHLENBQUMrQixJQUFKO0FBQ0E5QixNQUFBQSxNQUFNLENBQUNQLE9BQU8sQ0FBQ3NDLElBQVQsQ0FBTixDQUFxQnRCLHFCQUFyQixDQUEyQyxDQUEzQztBQUNELEtBTkcsQ0FBSjtBQU9ELEdBZk8sQ0FBUjtBQWlCQWxCLEVBQUFBLFFBQVEsQ0FBQyxXQUFELEVBQWMsTUFBTTtBQUMxQk8sSUFBQUEsSUFBSSxDQUFDLDRCQUFELEVBQStCLFlBQVk7QUFDN0MsWUFBTUMsR0FBRyxHQUFHVixLQUFLLEVBQWpCO0FBQ0EsWUFBTXdCLEVBQUUsR0FBR2pCLElBQUksQ0FBQ1UsRUFBTCxFQUFYO0FBQ0FQLE1BQUFBLEdBQUcsQ0FBQ2lDLElBQUosR0FBV3BDLElBQUksQ0FBQ1UsRUFBTCxFQUFYO0FBQ0FQLE1BQUFBLEdBQUcsQ0FBQ3VCLE1BQUosR0FBYTFCLElBQUksQ0FBQ1UsRUFBTCxFQUFiO0FBQ0EsWUFBTVAsR0FBRyxDQUFDa0MsS0FBSixDQUFVcEIsRUFBVixDQUFOO0FBQ0FiLE1BQUFBLE1BQU0sQ0FBQ0QsR0FBRyxDQUFDaUMsSUFBTCxDQUFOLENBQWlCdkIscUJBQWpCLENBQXVDLENBQXZDO0FBQ0FULE1BQUFBLE1BQU0sQ0FBQ0QsR0FBRyxDQUFDdUIsTUFBTCxDQUFOLENBQW1CYixxQkFBbkIsQ0FBeUMsQ0FBekM7QUFDQVQsTUFBQUEsTUFBTSxDQUFDRCxHQUFHLENBQUN1QixNQUFMLENBQU4sQ0FBbUJZLG9CQUFuQixDQUF3Q3JCLEVBQXhDO0FBQ0QsS0FURyxDQUFKO0FBV0FmLElBQUFBLElBQUksQ0FBQyw4Q0FBRCxFQUFpRCxZQUFZO0FBQy9ELFlBQU1DLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBLFlBQU13QixFQUFFLEdBQUdqQixJQUFJLENBQUNVLEVBQUwsRUFBWDtBQUNBUCxNQUFBQSxHQUFHLENBQUN1QixNQUFKLEdBQWExQixJQUFJLENBQUNVLEVBQUwsRUFBYjtBQUNBUCxNQUFBQSxHQUFHLENBQUNvQyxRQUFKLEdBQWUsSUFBZjtBQUNBLFlBQU1wQyxHQUFHLENBQUNrQyxLQUFKLENBQVVwQixFQUFWLENBQU47QUFDQWIsTUFBQUEsTUFBTSxDQUFDRCxHQUFHLENBQUN1QixNQUFMLENBQU4sQ0FBbUJiLHFCQUFuQixDQUF5QyxDQUF6QztBQUNBVCxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ3VCLE1BQUwsQ0FBTixDQUFtQlksb0JBQW5CLENBQXdDckIsRUFBeEM7QUFDRCxLQVJHLENBQUo7QUFVQWYsSUFBQUEsSUFBSSxDQUFDLDRDQUFELEVBQStDLFlBQVk7QUFDN0QsWUFBTUMsR0FBRyxHQUFHVixLQUFLLEVBQWpCO0FBQ0EsWUFBTXdCLEVBQUUsR0FBR2pCLElBQUksQ0FBQ1UsRUFBTCxFQUFYO0FBQ0FQLE1BQUFBLEdBQUcsQ0FBQ2lDLElBQUosR0FBV3BDLElBQUksQ0FBQ1UsRUFBTCxFQUFYO0FBQ0FQLE1BQUFBLEdBQUcsQ0FBQ3VCLE1BQUosR0FBYTFCLElBQUksQ0FBQ1UsRUFBTCxDQUFRLE1BQU07QUFDekIsY0FBTSxJQUFJOEIsS0FBSixDQUFVLE9BQVYsQ0FBTjtBQUNELE9BRlksQ0FBYjtBQUdBckMsTUFBQUEsR0FBRyxDQUFDVyxhQUFKLEdBQW9CZCxJQUFJLENBQUNVLEVBQUwsRUFBcEI7QUFDQSxZQUFNUCxHQUFHLENBQUNrQyxLQUFKLENBQVVwQixFQUFWLENBQU47QUFDQWIsTUFBQUEsTUFBTSxDQUFDRCxHQUFHLENBQUNpQyxJQUFMLENBQU4sQ0FBaUJ2QixxQkFBakIsQ0FBdUMsQ0FBdkM7QUFDQVQsTUFBQUEsTUFBTSxDQUFDRCxHQUFHLENBQUN1QixNQUFMLENBQU4sQ0FBbUJiLHFCQUFuQixDQUF5QyxDQUF6QztBQUNBVCxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ1csYUFBTCxDQUFOLENBQTBCRCxxQkFBMUIsQ0FBZ0QsQ0FBaEQ7QUFDQVQsTUFBQUEsTUFBTSxDQUFDRCxHQUFHLENBQUN1QixNQUFMLENBQU4sQ0FBbUJZLG9CQUFuQixDQUF3Q3JCLEVBQXhDO0FBQ0QsS0FiRyxDQUFKO0FBY0QsR0FwQ08sQ0FBUjtBQXNDQXRCLEVBQUFBLFFBQVEsQ0FBQyxhQUFELEVBQWdCLE1BQU07QUFDNUJPLElBQUFBLElBQUksQ0FBQyw4QkFBRCxFQUFpQyxZQUFZO0FBQy9DLFlBQU1DLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBVSxNQUFBQSxHQUFHLENBQUNzQyxFQUFKLEdBQVM7QUFBRW5CLFFBQUFBLE9BQU8sRUFBRXRCLElBQUksQ0FBQ1UsRUFBTDtBQUFYLE9BQVQ7QUFDQVAsTUFBQUEsR0FBRyxDQUFDdUMsT0FBSixHQUFjO0FBQUVDLFFBQUFBLE9BQU8sRUFBRTtBQUFFckIsVUFBQUEsT0FBTyxFQUFFdEIsSUFBSSxDQUFDVSxFQUFMO0FBQVgsU0FBWDtBQUFtQ2tDLFFBQUFBLE9BQU8sRUFBRTtBQUE1QyxPQUFkO0FBQ0F6QyxNQUFBQSxHQUFHLENBQUMwQyxRQUFKLENBQWFDLGtCQUFiLEdBQWtDOUMsSUFBSSxDQUFDVSxFQUFMLEVBQWxDO0FBQ0FQLE1BQUFBLEdBQUcsQ0FBQzRDLEtBQUosQ0FBVXpCLE9BQVYsR0FBb0J0QixJQUFJLENBQUNVLEVBQUwsRUFBcEI7QUFDQSxZQUFNUCxHQUFHLENBQUNtQixPQUFKLEVBQU47QUFDQWxCLE1BQUFBLE1BQU0sQ0FBQ0QsR0FBRyxDQUFDNEMsS0FBSixDQUFVekIsT0FBWCxDQUFOLENBQTBCVCxxQkFBMUIsQ0FBZ0QsQ0FBaEQ7QUFDQVQsTUFBQUEsTUFBTSxDQUFDRCxHQUFHLENBQUNzQyxFQUFKLENBQU9uQixPQUFSLENBQU4sQ0FBdUJULHFCQUF2QixDQUE2QyxDQUE3QztBQUNBVCxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ3VDLE9BQUosQ0FBWUMsT0FBWixDQUFvQnJCLE9BQXJCLENBQU4sQ0FBb0NULHFCQUFwQyxDQUEwRCxDQUExRDtBQUNELEtBVkcsQ0FBSjtBQVlBWCxJQUFBQSxJQUFJLENBQUMsMkNBQUQsRUFBOEMsWUFBWTtBQUM1RCxZQUFNQyxHQUFHLEdBQUdWLEtBQUssRUFBakI7QUFDQVUsTUFBQUEsR0FBRyxDQUFDdUMsT0FBSixHQUFjO0FBQUVDLFFBQUFBLE9BQU8sRUFBRTtBQUFFckIsVUFBQUEsT0FBTyxFQUFFdEIsSUFBSSxDQUFDVSxFQUFMO0FBQVgsU0FBWDtBQUFtQ2tDLFFBQUFBLE9BQU8sRUFBRTtBQUE1QyxPQUFkO0FBQ0F6QyxNQUFBQSxHQUFHLENBQUMwQyxRQUFKLENBQWFDLGtCQUFiLEdBQWtDOUMsSUFBSSxDQUFDVSxFQUFMLEVBQWxDO0FBQ0EsYUFBT1AsR0FBRyxDQUFDUSxNQUFKLENBQVdXLE9BQWxCO0FBQ0EsYUFBT25CLEdBQUcsQ0FBQzRDLEtBQVg7QUFDQSxZQUFNNUMsR0FBRyxDQUFDbUIsT0FBSixFQUFOO0FBQ0FsQixNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ3VDLE9BQUosQ0FBWUMsT0FBWixDQUFvQnJCLE9BQXJCLENBQU4sQ0FBb0NULHFCQUFwQyxDQUEwRCxDQUExRDtBQUNELEtBUkcsQ0FBSjtBQVNELEdBdEJPLENBQVI7QUF3QkFsQixFQUFBQSxRQUFRLENBQUMsVUFBRCxFQUFhLE1BQU07QUFDekJPLElBQUFBLElBQUksQ0FBQywyQkFBRCxFQUE4QixZQUFZO0FBQzVDLFlBQU1DLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBVSxNQUFBQSxHQUFHLENBQUNBLEdBQUosR0FBVTtBQUFFNkMsUUFBQUEsR0FBRyxFQUFFaEQsSUFBSSxDQUFDVSxFQUFMO0FBQVAsT0FBVjtBQUNBLFlBQU1QLEdBQUcsQ0FBQ2lDLElBQUosRUFBTjtBQUNBaEMsTUFBQUEsTUFBTSxDQUFDRCxHQUFHLENBQUNBLEdBQUosQ0FBUTZDLEdBQVQsQ0FBTixDQUFvQkMsZ0JBQXBCO0FBQ0QsS0FMRyxDQUFKO0FBT0EvQyxJQUFBQSxJQUFJLENBQUMseUNBQUQsRUFBNEMsWUFBWTtBQUMxREwsTUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlvRCxRQUFaLEdBQXVCLGFBQXZCO0FBQ0EsWUFBTS9DLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBVSxNQUFBQSxHQUFHLENBQUNBLEdBQUosR0FBVTtBQUFFNkMsUUFBQUEsR0FBRyxFQUFFaEQsSUFBSSxDQUFDVSxFQUFMO0FBQVAsT0FBVjtBQUNBLFlBQU1QLEdBQUcsQ0FBQ2lDLElBQUosRUFBTjtBQUNBaEMsTUFBQUEsTUFBTSxDQUFDRCxHQUFHLENBQUNBLEdBQUosQ0FBUTZDLEdBQVQsQ0FBTixDQUFvQkMsZ0JBQXBCO0FBQ0QsS0FORyxDQUFKO0FBT0QsR0FmTyxDQUFSO0FBaUJBL0MsRUFBQUEsSUFBSSxDQUFDLHFEQUFELEVBQXdELFlBQVk7QUFDdEUsVUFBTUMsR0FBRyxHQUFHVixLQUFLLEVBQWpCO0FBQ0EsVUFBTTBELEdBQUcsR0FBRyxFQUFaO0FBQ0EsVUFBTUMsR0FBRyxHQUFHO0FBQUVDLE1BQUFBLE1BQU0sRUFBRXJELElBQUksQ0FBQ1UsRUFBTDtBQUFWLEtBQVo7QUFDQSxVQUFNNEMsSUFBSSxHQUFHdEQsSUFBSSxDQUFDVSxFQUFMLEVBQWI7QUFDQSxVQUFNUCxHQUFHLENBQUNvRCxNQUFKLENBQVdKLEdBQVgsRUFBZ0JDLEdBQWhCLEVBQXFCRSxJQUFyQixDQUFOO0FBQ0FsRCxJQUFBQSxNQUFNLENBQUNrRCxJQUFELENBQU4sQ0FBYXpDLHFCQUFiLENBQW1DLENBQW5DO0FBQ0QsR0FQRyxDQUFKO0FBU0FYLEVBQUFBLElBQUksQ0FBQyxtREFBRCxFQUFzRCxZQUFZO0FBQ3BFLFVBQU1DLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBLFVBQU0wRCxHQUFHLEdBQUc7QUFBRUssTUFBQUEsR0FBRyxFQUFFLFVBQVA7QUFBbUJDLE1BQUFBLE1BQU0sRUFBRTtBQUEzQixLQUFaO0FBQ0EsVUFBTUwsR0FBRyxHQUFHO0FBQUVDLE1BQUFBLE1BQU0sRUFBRXJELElBQUksQ0FBQ1UsRUFBTCxHQUFVZ0Qsa0JBQVYsQ0FBOEJMLE1BQUQsSUFBWUEsTUFBekM7QUFBVixLQUFaO0FBQ0EsVUFBTUMsSUFBSSxHQUFHdEQsSUFBSSxDQUFDVSxFQUFMLEVBQWI7QUFDQSxVQUFNaUQsSUFBSSxHQUFHLE1BQU14RCxHQUFHLENBQUNvRCxNQUFKLENBQVdKLEdBQVgsRUFBZ0JDLEdBQWhCLEVBQXFCRSxJQUFyQixDQUFuQjtBQUNBbEQsSUFBQUEsTUFBTSxDQUFDdUQsSUFBRCxDQUFOLENBQWFDLElBQWIsQ0FBa0IsR0FBbEI7QUFDQXhELElBQUFBLE1BQU0sQ0FBQ2dELEdBQUcsQ0FBQ0MsTUFBTCxDQUFOLENBQW1CeEMscUJBQW5CLENBQXlDLENBQXpDO0FBQ0QsR0FSRyxDQUFKO0FBVUFYLEVBQUFBLElBQUksQ0FBQyx3REFBRCxFQUEyRCxZQUFZO0FBQ3pFLFVBQU1DLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBLFVBQU1vRSxHQUFHLEdBQUcsRUFBWjtBQUNBLFVBQU1WLEdBQUcsR0FBRyxFQUFaO0FBQ0EsVUFBTUMsR0FBRyxHQUFHO0FBQ1ZDLE1BQUFBLE1BQU0sRUFBRXJELElBQUksQ0FBQ1UsRUFBTCxHQUFVZ0Qsa0JBQVYsQ0FBOEJMLE1BQUQsS0FBYTtBQUNoRFMsUUFBQUEsSUFBSSxFQUFFOUQsSUFBSSxDQUFDVSxFQUFMLEdBQVVnRCxrQkFBVixDQUE4QkssT0FBRCxJQUFhQSxPQUExQztBQUQwQyxPQUFiLENBQTdCO0FBREUsS0FBWjtBQUtBNUQsSUFBQUEsR0FBRyxDQUFDNkQsV0FBSixDQUFnQkgsR0FBaEIsRUFBcUJWLEdBQXJCLEVBQTBCQyxHQUExQjtBQUNBaEQsSUFBQUEsTUFBTSxDQUFDZ0QsR0FBRyxDQUFDQyxNQUFMLENBQU4sQ0FBbUJ4QyxxQkFBbkIsQ0FBeUMsQ0FBekM7QUFDRCxHQVhHLENBQUo7QUFhQVgsRUFBQUEsSUFBSSxDQUFDLHdDQUFELEVBQTJDLFlBQVk7QUFDekQsVUFBTUMsR0FBRyxHQUFHVixLQUFLLEVBQWpCO0FBQ0FVLElBQUFBLEdBQUcsQ0FBQzJCLGlCQUFKO0FBQ0QsR0FIRyxDQUFKO0FBS0FuQyxFQUFBQSxRQUFRLENBQUMseUJBQUQsRUFBNEIsTUFBTTtBQUN4Q08sSUFBQUEsSUFBSSxDQUFDLHVDQUFELEVBQTBDLFlBQVk7QUFDeEQsWUFBTUMsR0FBRyxHQUFHVixLQUFLLEVBQWpCO0FBQ0FVLE1BQUFBLEdBQUcsQ0FBQ3VDLE9BQUosR0FBYztBQUNadUIsUUFBQUEsS0FBSyxFQUFFO0FBQUV0QyxVQUFBQSxNQUFNLEVBQUU7QUFBRXVDLFlBQUFBLFNBQVMsRUFBRTtBQUFFQyxjQUFBQSxTQUFTLEVBQUU7QUFBYjtBQUFiO0FBQVY7QUFESyxPQUFkO0FBSUEsWUFBTWhFLEdBQUcsQ0FBQ2lFLHFCQUFKLEVBQU47QUFDRCxLQVBHLENBQUo7QUFTQWxFLElBQUFBLElBQUksQ0FBQyx1Q0FBRCxFQUEwQyxZQUFZO0FBQ3hELFlBQU1DLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBVSxNQUFBQSxHQUFHLENBQUMrQixJQUFKLEdBQVdsQyxJQUFJLENBQUNVLEVBQUwsRUFBWDtBQUNBUCxNQUFBQSxHQUFHLENBQUN1QyxPQUFKLEdBQWM7QUFDWnVCLFFBQUFBLEtBQUssRUFBRTtBQUFFdEMsVUFBQUEsTUFBTSxFQUFFO0FBQUV1QyxZQUFBQSxTQUFTLEVBQUU7QUFBRUMsY0FBQUEsU0FBUyxFQUFFO0FBQWI7QUFBYjtBQUFWO0FBREssT0FBZDtBQUlBLFlBQU1oRSxHQUFHLENBQUNpRSxxQkFBSixFQUFOO0FBQ0FoRSxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQytCLElBQUwsQ0FBTixDQUFpQnJCLHFCQUFqQixDQUF1QyxDQUF2QztBQUNELEtBVEcsQ0FBSjtBQVVELEdBcEJPLENBQVI7QUFzQkFYLEVBQUFBLElBQUksQ0FBQyw2QkFBRCxFQUFnQyxNQUFNO0FBQ3hDLFVBQU1DLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBVSxJQUFBQSxHQUFHLENBQUNrRSxNQUFKO0FBQ0QsR0FIRyxDQUFKO0FBS0ExRSxFQUFBQSxRQUFRLENBQUMsZUFBRCxFQUFrQixNQUFNO0FBQzlCLFVBQU1RLEdBQUcsR0FBR1YsS0FBSyxFQUFqQjtBQUNBUyxJQUFBQSxJQUFJLENBQUMseUJBQUQsRUFBNEIsTUFBTTtBQUNwQ0MsTUFBQUEsR0FBRyxDQUFDc0MsRUFBSixHQUFTO0FBQ1A2QixRQUFBQSxRQUFRLEVBQUV0RSxJQUFJLENBQUNVLEVBQUwsQ0FBUSxNQUFNLE9BQWQ7QUFESCxPQUFUO0FBR0FOLE1BQUFBLE1BQU0sQ0FBQ0QsR0FBRyxDQUFDbUUsUUFBSixFQUFELENBQU4sQ0FBdUJWLElBQXZCLENBQTRCLE9BQTVCO0FBQ0F4RCxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ3NDLEVBQUosQ0FBTzZCLFFBQVIsQ0FBTixDQUF3QnpELHFCQUF4QixDQUE4QyxDQUE5QztBQUNELEtBTkcsQ0FBSjtBQVFBWCxJQUFBQSxJQUFJLENBQUMscUJBQUQsRUFBd0IsTUFBTTtBQUNoQ0MsTUFBQUEsR0FBRyxDQUFDc0MsRUFBSixHQUFTO0FBQ1A4QixRQUFBQSxLQUFLLEVBQUV2RSxJQUFJLENBQUNVLEVBQUwsQ0FBUSxNQUFNLE9BQWQ7QUFEQSxPQUFUO0FBR0FOLE1BQUFBLE1BQU0sQ0FBQ0QsR0FBRyxDQUFDb0UsS0FBSixFQUFELENBQU4sQ0FBb0JYLElBQXBCLENBQXlCLE9BQXpCO0FBQ0F4RCxNQUFBQSxNQUFNLENBQUNELEdBQUcsQ0FBQ3NDLEVBQUosQ0FBTzhCLEtBQVIsQ0FBTixDQUFxQjFELHFCQUFyQixDQUEyQyxDQUEzQztBQUNELEtBTkcsQ0FBSjtBQU9ELEdBakJPLENBQVI7QUFrQkQsQ0FuV08sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHNnQXBwID0gcmVxdWlyZSgnLi4vQXBwJyk7XG5cbmRlc2NyaWJlKCdJbml0IEFwcCcsICgpID0+IHtcbiAgY29uc3QgT0xEX0VOViA9IHByb2Nlc3MuZW52O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QucmVzZXRNb2R1bGVzKCk7XG4gICAgcHJvY2Vzcy5lbnYgPSB7IC4uLk9MRF9FTlYgfTtcbiAgfSk7XG5cbiAgdGVzdCgnU2hvdWxkIGluaXRpYWwgQXBwJywgKCkgPT4ge1xuICAgIGNvbnN0IGFwcCA9IHNnQXBwKCk7XG4gICAgZXhwZWN0KE9iamVjdC5rZXlzKGFwcCkpLnRvRXF1YWwoW1xuICAgICAgJ2FwcCcsXG4gICAgICAncm91dGVyJyxcbiAgICAgICdzZXJ2ZXInLFxuICAgICAgJ2xvZycsXG4gICAgICAnZGlyJyxcbiAgICAgICdhZG1pbicsXG4gICAgICAncGx1Z2lucycsXG4gICAgICAnY29uZmlnJyxcbiAgICAgICdpc0xvYWRlZCcsXG4gICAgICAnZnMnLFxuICAgICAgJ2V2ZW50SHViJyxcbiAgICBdKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0luaXRTZXJ2ZXIgZXJyb3InLCAoKSA9PiB7XG4gICAgdGVzdCgnU2hvdWxkIGluaXRTZXJ2ZXIgZXJyb3InLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhcHAgPSBzZ0FwcCgpO1xuICAgICAgYXBwLmxvZy5lcnJvciA9IGplc3QuZm4oKCkgPT4gJ2Vycm9yJyk7XG4gICAgICBhcHAuc2VydmVyLl9ldmVudHMuZXJyb3IoJ2Vycm9yJyk7XG4gICAgICBleHBlY3QoYXBwLmxvZy5lcnJvcikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnU2hvdWxkIGluaXRTZXJ2ZXIgZXJyb3Igd2hlbiB0aGUgcG9ydCBpcyBhbHJlYWR5IHVzZWQgYnkgYW5vdGhlciBhcHBsaWNhdGlvbi4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhcHAgPSBzZ0FwcCgpO1xuICAgICAgYXBwLnN0b3BXaXRoRXJyb3IgPSBqZXN0LmZuKCk7XG4gICAgICBhcHAuc2VydmVyLl9ldmVudHMuZXJyb3IoeyBjb2RlOiAnRUFERFJJTlVTRScsIHBvcnQ6IDQwMDAgfSk7XG4gICAgICBleHBlY3QoYXBwLnN0b3BXaXRoRXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ1Nob3VsZCBpbml0U2VydmVyLCBjb25uZWN0IGFuZCBkZXN0cm95IHNlcnZlci4nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBjYiA9IGplc3QuZm4oKTtcbiAgICAgIGNvbnN0IGFwcCA9IHNnQXBwKCk7XG4gICAgICBjb25zdCBjb25uID0ge1xuICAgICAgICByZW1vdGVBZGRyZXNzOiAnbG9jYWxob3N0JyxcbiAgICAgICAgcmVtb3RlUG9ydDogNDAwMCxcbiAgICAgICAgb246IGplc3QuZm4oKSxcbiAgICAgICAgZGVzdHJveTogamVzdC5mbigpLFxuICAgICAgfTtcbiAgICAgIGFwcC5zZXJ2ZXIuY2xvc2UgPSBqZXN0LmZuKCk7XG5cbiAgICAgIGFwcC5pbml0U2VydmVyKCk7XG4gICAgICBhcHAuc2VydmVyLl9ldmVudHMuY29ubmVjdGlvblsxXShjb25uKTtcbiAgICAgIGFwcC5zZXJ2ZXIuZGVzdHJveShjYik7XG4gICAgICBleHBlY3QoY29ubi5kZXN0cm95KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdMaXN0ZW4gYmVoYXZpb3JzIHRvIHRoZSBzZXJ2ZXInLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGNhbGwgbGlzdGVuIGZ1bmN0aW9uLCBsaXN0ZW4gb24gcG9ydCBhbmQgaG9zdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGFwcCA9IHNnQXBwKCk7XG4gICAgICBhcHAuc2VydmVyLmxpc3RlbiA9IGplc3QuZm4oKTtcbiAgICAgIGFwcC5saXN0ZW4oKTtcbiAgICAgIGV4cGVjdChhcHAuc2VydmVyLmxpc3RlbikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGNhbGwgbGlzdGVuIGZ1bmN0aW9uLCBsaXN0ZW4gb24gc29ja2V0JywgKCkgPT4ge1xuICAgICAgY29uc3QgYXBwID0gc2dBcHAoKTtcbiAgICAgIGFwcC5zZXJ2ZXIubGlzdGVuID0gamVzdC5mbigpO1xuICAgICAgYXBwLmNvbmZpZy5nZXQgPSBqZXN0LmZuKChrZXkpID0+IHtcbiAgICAgICAgaWYgKGtleSA9PSAnc2VydmVyLnNvY2tldCcpIHJldHVybiAnc2VydmVyLnNvY2tldCc7XG4gICAgICB9KTtcbiAgICAgIGFwcC5saXN0ZW4oKTtcbiAgICAgIGV4cGVjdChhcHAuc2VydmVyLmxpc3RlbikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgZXhwZWN0KGFwcC5jb25maWcuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgY2FsbCBsaXN0ZW5FcnJIYW5kbGVyJywgKCkgPT4ge1xuICAgICAgY29uc3QgY2IgPSBqZXN0LmZuKCk7XG4gICAgICBjb25zdCBhcHAgPSBzZ0FwcCgpO1xuICAgICAgYXBwLmxvZ1N0YXJ0dXBNZXNzYWdlID0gamVzdC5mbigpO1xuICAgICAgYXBwLnNlcnZlci5saXN0ZW4gPSBqZXN0LmZuKChsaXN0ZW4sIGNhbGxiYWNrKSA9PiB7XG4gICAgICAgIGlmIChsaXN0ZW4gPT0gJ2Vycm9yJykgY2FsbGJhY2soKTtcbiAgICAgIH0pO1xuICAgICAgYXBwLmNvbmZpZy5nZXQgPSBqZXN0LmZuKChrZXkpID0+IHtcbiAgICAgICAgaWYgKGtleSA9PSAnc2VydmVyLnNvY2tldCcpIHJldHVybiAnZXJyb3InO1xuICAgICAgfSk7XG4gICAgICBhcHAubGlzdGVuKGNiKTtcbiAgICAgIGV4cGVjdChjYikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgZXhwZWN0KGFwcC5zZXJ2ZXIubGlzdGVuKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICBleHBlY3QoYXBwLmNvbmZpZy5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICAgIGV4cGVjdChhcHAubG9nU3RhcnR1cE1lc3NhZ2UpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBjYWxsIGxpc3RlbkVyckhhbmRsZXIgd2l0aCBhIGVycm9yJywgKCkgPT4ge1xuICAgICAgY29uc3QgYXBwID0gc2dBcHAoKTtcbiAgICAgIGFwcC5zdG9wV2l0aEVycm9yID0gamVzdC5mbigpO1xuICAgICAgYXBwLnNlcnZlci5saXN0ZW4gPSBqZXN0LmZuKChsaXN0ZW4sIGNhbGxiYWNrKSA9PiB7XG4gICAgICAgIGlmIChsaXN0ZW4gPT0gJ2Vycm9yJykgY2FsbGJhY2soJ2Vycm9yJyk7XG4gICAgICB9KTtcbiAgICAgIGFwcC5jb25maWcuZ2V0ID0gamVzdC5mbigoa2V5KSA9PiB7XG4gICAgICAgIGlmIChrZXkgPT0gJ3NlcnZlci5zb2NrZXQnKSByZXR1cm4gJ2Vycm9yJztcbiAgICAgIH0pO1xuICAgICAgYXBwLmxpc3RlbigpO1xuICAgICAgZXhwZWN0KGFwcC5zZXJ2ZXIubGlzdGVuKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICBleHBlY3QoYXBwLmNvbmZpZy5nZXQpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICAgIGV4cGVjdChhcHAuc3RvcFdpdGhFcnJvcikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGNhbGwgbGlzdGVuRXJySGFuZGxlciB3aXRoIEhJREVfU1RBUlRVUF9NRVNTQUdFPXRydWUnLCAoKSA9PiB7XG4gICAgICBwcm9jZXNzLmVudi5ISURFX1NUQVJUVVBfTUVTU0FHRSA9IHRydWU7XG4gICAgICBjb25zdCBhcHAgPSBzZ0FwcCgpO1xuICAgICAgYXBwLnNlcnZlci5saXN0ZW4gPSBqZXN0LmZuKChsaXN0ZW4sIGNhbGxiYWNrKSA9PiB7XG4gICAgICAgIGlmIChsaXN0ZW4gPT0gJ2Vycm9yJykgY2FsbGJhY2soKTtcbiAgICAgIH0pO1xuICAgICAgYXBwLmNvbmZpZy5nZXQgPSBqZXN0LmZuKChrZXkpID0+IHtcbiAgICAgICAgaWYgKGtleSA9PSAnc2VydmVyLnNvY2tldCcpIHJldHVybiAnZXJyb3InO1xuICAgICAgfSk7XG4gICAgICBhcHAubGlzdGVuKCk7XG4gICAgICBleHBlY3QoYXBwLnNlcnZlci5saXN0ZW4pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICAgIGV4cGVjdChhcHAuY29uZmlnLmdldCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGNhbGwgbGlzdGVuRXJySGFuZGxlciB3aXRoIEhJREVfU1RBUlRVUF9NRVNTQUdFPWZhbHNlJywgKCkgPT4ge1xuICAgICAgcHJvY2Vzcy5lbnYuSElERV9TVEFSVFVQX01FU1NBR0UgPSBmYWxzZTtcbiAgICAgIGNvbnN0IGFwcCA9IHNnQXBwKCk7XG4gICAgICBhcHAubG9nU3RhcnR1cE1lc3NhZ2UgPSBqZXN0LmZuKCk7XG4gICAgICBhcHAuc2VydmVyLmxpc3RlbiA9IGplc3QuZm4oKGxpc3RlbiwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgaWYgKGxpc3RlbiA9PSAnZXJyb3InKSBjYWxsYmFjaygpO1xuICAgICAgfSk7XG4gICAgICBhcHAuY29uZmlnLmdldCA9IGplc3QuZm4oKGtleSkgPT4ge1xuICAgICAgICBpZiAoa2V5ID09ICdzZXJ2ZXIuc29ja2V0JykgcmV0dXJuICdlcnJvcic7XG4gICAgICB9KTtcbiAgICAgIGFwcC5saXN0ZW4oKTtcbiAgICAgIGV4cGVjdChhcHAuc2VydmVyLmxpc3RlbikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgZXhwZWN0KGFwcC5jb25maWcuZ2V0KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICBleHBlY3QoYXBwLmxvZ1N0YXJ0dXBNZXNzYWdlKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTZXJ2ZXIgY29ubmVjdGlvbicsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgY29ubmVjdGlvbiB0byBzZXJ2ZXInLCAoKSA9PiB7XG4gICAgICBjb25zdCBhcHAgPSBzZ0FwcCgpO1xuICAgICAgY29uc3QgY29ubiA9IHtcbiAgICAgICAgcmVtb3RlQWRkcmVzczogJ2xvY2FsaG9zdCcsXG4gICAgICAgIHJlbW90ZVBvcnQ6IDQwMDAsXG4gICAgICAgIG9uOiBqZXN0LmZuKCh0eXBlLCBjYWxsYmFjaykgPT4ge1xuICAgICAgICAgIGlmICh0eXBlID09ICdjbG9zZScpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KSxcbiAgICAgIH07XG4gICAgICBhcHAuc2VydmVyLl9ldmVudHMuY29ubmVjdGlvblsxXShjb25uKTtcbiAgICAgIGV4cGVjdChjb25uLm9uKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdTdG9wIFdpdGhFcnJvcicsICgpID0+IHtcbiAgICB0ZXN0KCdTaG91bGQgY2FsbCBzdG9wV2l0aEVycm9yIGZ1bmN0aW9uIHdpdGggY3VzdG9tTWVzc2FnZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGFwcCA9IHNnQXBwKCk7XG4gICAgICBhcHAuc3RvcCA9IGplc3QuZm4oKTtcbiAgICAgIGFwcC5sb2cuZXJyb3IgPSBqZXN0LmZuKCk7XG4gICAgICBhcHAuc3RvcFdpdGhFcnJvcignZXJyb3InLCAnY3VzdG9tTWVzc2FnZScpO1xuICAgICAgZXhwZWN0KGFwcC5zdG9wKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICBleHBlY3QoYXBwLmxvZy5lcnJvcikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDIpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnU2hvdWxkIGNhbGwgc3RvcFdpdGhFcnJvciBmdW5jdGlvbiB3aXRoIGRvZXMgbm90IGhhdmUgY3VzdG9tTWVzc2FnZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGFwcCA9IHNnQXBwKCk7XG4gICAgICBhcHAuc3RvcCA9IGplc3QuZm4oKTtcbiAgICAgIGFwcC5sb2cuZXJyb3IgPSBqZXN0LmZuKCk7XG4gICAgICBhcHAuc3RvcFdpdGhFcnJvcignZXJyb3InKTtcbiAgICAgIGV4cGVjdChhcHAuc3RvcCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgZXhwZWN0KGFwcC5sb2cuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1N0b3AgYXBwJywgKCkgPT4ge1xuICAgIHRlc3QoJ1Nob3VsZCBjYWxsIHN0b3AgZnVuY3Rpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhcHAgPSBzZ0FwcCgpO1xuICAgICAgcHJvY2Vzcy5leGl0ID0gamVzdC5mbigpO1xuICAgICAgYXBwLnN0b3AoKTtcbiAgICAgIGV4cGVjdChwcm9jZXNzLmV4aXQpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ1Nob3VsZCBjYWxsIHN0b3AgZnVuY3Rpb24gaW4gY2FzZSBkb2VzIG5vdCBoYXZlIHNlcnZlciBkZXN0cm95IGZ1bmN0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYXBwID0gc2dBcHAoKTtcbiAgICAgIGRlbGV0ZSBhcHAuc2VydmVyLmRlc3Ryb3k7XG4gICAgICBwcm9jZXNzLmV4aXQgPSBqZXN0LmZuKCk7XG4gICAgICBhcHAuc3RvcCgpO1xuICAgICAgZXhwZWN0KHByb2Nlc3MuZXhpdCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnU3RhcnQgYXBwJywgKCkgPT4ge1xuICAgIHRlc3QoJ1Nob3VsZCBjYWxsIHN0YXJ0IGZ1bmN0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYXBwID0gc2dBcHAoKTtcbiAgICAgIGNvbnN0IGNiID0gamVzdC5mbigpO1xuICAgICAgYXBwLmxvYWQgPSBqZXN0LmZuKCk7XG4gICAgICBhcHAubGlzdGVuID0gamVzdC5mbigpO1xuICAgICAgYXdhaXQgYXBwLnN0YXJ0KGNiKTtcbiAgICAgIGV4cGVjdChhcHAubG9hZCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgZXhwZWN0KGFwcC5saXN0ZW4pLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICAgIGV4cGVjdChhcHAubGlzdGVuKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChjYik7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdTaG91bGQgY2FsbCBzdGFydCBmdW5jdGlvbiBhbmQgbm90IGNhbGwgbG9hZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGFwcCA9IHNnQXBwKCk7XG4gICAgICBjb25zdCBjYiA9IGplc3QuZm4oKTtcbiAgICAgIGFwcC5saXN0ZW4gPSBqZXN0LmZuKCk7XG4gICAgICBhcHAuaXNMb2FkZWQgPSB0cnVlO1xuICAgICAgYXdhaXQgYXBwLnN0YXJ0KGNiKTtcbiAgICAgIGV4cGVjdChhcHAubGlzdGVuKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICBleHBlY3QoYXBwLmxpc3RlbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoY2IpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnU2hvdWxkIGNhbGwgc3RhcnQgZnVuY3Rpb24gYW5kIHRocm93IGVycm9yJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYXBwID0gc2dBcHAoKTtcbiAgICAgIGNvbnN0IGNiID0gamVzdC5mbigpO1xuICAgICAgYXBwLmxvYWQgPSBqZXN0LmZuKCk7XG4gICAgICBhcHAubGlzdGVuID0gamVzdC5mbigoKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignZXJyb3InKTtcbiAgICAgIH0pO1xuICAgICAgYXBwLnN0b3BXaXRoRXJyb3IgPSBqZXN0LmZuKCk7XG4gICAgICBhd2FpdCBhcHAuc3RhcnQoY2IpO1xuICAgICAgZXhwZWN0KGFwcC5sb2FkKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICBleHBlY3QoYXBwLmxpc3RlbikudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgICAgZXhwZWN0KGFwcC5zdG9wV2l0aEVycm9yKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICBleHBlY3QoYXBwLmxpc3RlbikudG9IYXZlQmVlbkNhbGxlZFdpdGgoY2IpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRGVzdHJveSBhcHAnLCAoKSA9PiB7XG4gICAgdGVzdCgnU2hvdWxkIGNhbGwgZGVzdHJveSBmdW5jdGlvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGFwcCA9IHNnQXBwKCk7XG4gICAgICBhcHAuZGIgPSB7IGRlc3Ryb3k6IGplc3QuZm4oKSB9O1xuICAgICAgYXBwLnBsdWdpbnMgPSB7IHBsdWdpbjE6IHsgZGVzdHJveTogamVzdC5mbigpIH0sIHBsdWdpbjI6IHt9IH07XG4gICAgICBhcHAuZXZlbnRIdWIucmVtb3ZlQWxsTGlzdGVuZXJzID0gamVzdC5mbigpO1xuICAgICAgYXBwLmFkbWluLmRlc3Ryb3kgPSBqZXN0LmZuKCk7XG4gICAgICBhd2FpdCBhcHAuZGVzdHJveSgpO1xuICAgICAgZXhwZWN0KGFwcC5hZG1pbi5kZXN0cm95KS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICBleHBlY3QoYXBwLmRiLmRlc3Ryb3kpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICAgIGV4cGVjdChhcHAucGx1Z2lucy5wbHVnaW4xLmRlc3Ryb3kpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ1Nob3VsZCBjYWxsIGRlc3Ryb3kgZnVuY3Rpb24gaW4gY2FzZSBlbHNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYXBwID0gc2dBcHAoKTtcbiAgICAgIGFwcC5wbHVnaW5zID0geyBwbHVnaW4xOiB7IGRlc3Ryb3k6IGplc3QuZm4oKSB9LCBwbHVnaW4yOiB7fSB9O1xuICAgICAgYXBwLmV2ZW50SHViLnJlbW92ZUFsbExpc3RlbmVycyA9IGplc3QuZm4oKTtcbiAgICAgIGRlbGV0ZSBhcHAuc2VydmVyLmRlc3Ryb3k7XG4gICAgICBkZWxldGUgYXBwLmFkbWluO1xuICAgICAgYXdhaXQgYXBwLmRlc3Ryb3koKTtcbiAgICAgIGV4cGVjdChhcHAucGx1Z2lucy5wbHVnaW4xLmRlc3Ryb3kpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0xvYWQgQXBwJywgKCkgPT4ge1xuICAgIHRlc3QoJ1Nob3VsZCBjYWxsIGxvYWQgZnVuY3Rpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhcHAgPSBzZ0FwcCgpO1xuICAgICAgYXBwLmFwcCA9IHsgdXNlOiBqZXN0LmZuKCkgfTtcbiAgICAgIGF3YWl0IGFwcC5sb2FkKCk7XG4gICAgICBleHBlY3QoYXBwLmFwcC51c2UpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ1Nob3VsZCBjYWxsIGxvYWQgZnVuY3Rpb24gd2l0aCBtb2RlIGRldicsIGFzeW5jICgpID0+IHtcbiAgICAgIHByb2Nlc3MuZW52Lk5PREVfRU5WID0gJ2RldmVsb3BtZW50JztcbiAgICAgIGNvbnN0IGFwcCA9IHNnQXBwKCk7XG4gICAgICBhcHAuYXBwID0geyB1c2U6IGplc3QuZm4oKSB9O1xuICAgICAgYXdhaXQgYXBwLmxvYWQoKTtcbiAgICAgIGV4cGVjdChhcHAuYXBwLnVzZSkudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgY2FsbCBoZWFsdGggZnVuY3Rpb24gYW5kIGdvIHRvIG5leHQgZnVuY3Rpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgYXBwID0gc2dBcHAoKTtcbiAgICBjb25zdCByZXEgPSB7fTtcbiAgICBjb25zdCByZXMgPSB7IHN0YXR1czogamVzdC5mbigpIH07XG4gICAgY29uc3QgbmV4dCA9IGplc3QuZm4oKTtcbiAgICBhd2FpdCBhcHAuaGVhbHRoKHJlcSwgcmVzLCBuZXh0KTtcbiAgICBleHBlY3QobmV4dCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICB9KTtcblxuICB0ZXN0KCdzaG91bGQgY2FsbCBoZWFsdGggZnVuY3Rpb24gYW5kIHJldHVybiBzdGF0dXMgMjA0JywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGFwcCA9IHNnQXBwKCk7XG4gICAgY29uc3QgcmVxID0geyB1cmw6ICcvX2hlYWx0aCcsIG1ldGhvZDogJ0hFQUQnIH07XG4gICAgY29uc3QgcmVzID0geyBzdGF0dXM6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKHN0YXR1cykgPT4gc3RhdHVzKSB9O1xuICAgIGNvbnN0IG5leHQgPSBqZXN0LmZuKCk7XG4gICAgY29uc3QgcmVzcCA9IGF3YWl0IGFwcC5oZWFsdGgocmVxLCByZXMsIG5leHQpO1xuICAgIGV4cGVjdChyZXNwKS50b0JlKDIwNCk7XG4gICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvSGF2ZUJlZW5DYWxsZWRUaW1lcygxKTtcbiAgfSk7XG5cbiAgdGVzdCgnc2hvdWxkIGNhbGwgc2VydmVyRXJyb3IgZnVuY3Rpb24gYW5kIHJldHVybiBzdGF0dXMgNTAwJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGFwcCA9IHNnQXBwKCk7XG4gICAgY29uc3QgZXJyID0ge307XG4gICAgY29uc3QgcmVxID0ge307XG4gICAgY29uc3QgcmVzID0ge1xuICAgICAgc3RhdHVzOiBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKChzdGF0dXMpID0+ICh7XG4gICAgICAgIHNlbmQ6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKG1lc3NhZ2UpID0+IG1lc3NhZ2UpLFxuICAgICAgfSkpLFxuICAgIH07XG4gICAgYXBwLnNlcnZlckVycm9yKGVyciwgcmVxLCByZXMpO1xuICAgIGV4cGVjdChyZXMuc3RhdHVzKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gIH0pO1xuXG4gIHRlc3QoJ1Nob3VsZCBjYWxsIGxvZ1N0YXJ0dXBNZXNzYWdlIGZ1bmN0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGFwcCA9IHNnQXBwKCk7XG4gICAgYXBwLmxvZ1N0YXJ0dXBNZXNzYWdlKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSdW4gQm9vdHN0cmFwIEZ1bmN0aW9ucycsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgZXhlY0Jvb3RzdHJhcCByZXR1cm4gdW5kZWZpbmVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgYXBwID0gc2dBcHAoKTtcbiAgICAgIGFwcC5wbHVnaW5zID0ge1xuICAgICAgICBlbWFpbDogeyBjb25maWc6IHsgZnVuY3Rpb25zOiB7IGJvb3RzdHJhcDogbnVsbCB9IH0gfSxcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IGFwcC5ydW5Cb290c3RyYXBGdW5jdGlvbnMoKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBydW4gQm9vdHN0cmFwIGZ1bmN0aW9uIGlzIGZhaWwnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBhcHAgPSBzZ0FwcCgpO1xuICAgICAgYXBwLnN0b3AgPSBqZXN0LmZuKCk7XG4gICAgICBhcHAucGx1Z2lucyA9IHtcbiAgICAgICAgZW1haWw6IHsgY29uZmlnOiB7IGZ1bmN0aW9uczogeyBib290c3RyYXA6ICdib290c3RyYXAnIH0gfSB9LFxuICAgICAgfTtcblxuICAgICAgYXdhaXQgYXBwLnJ1bkJvb3RzdHJhcEZ1bmN0aW9ucygpO1xuICAgICAgZXhwZWN0KGFwcC5zdG9wKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ3Nob3VsZCBjYWxsIGZyZWV6ZSBmdW5jdGlvbicsICgpID0+IHtcbiAgICBjb25zdCBhcHAgPSBzZ0FwcCgpO1xuICAgIGFwcC5mcmVlemUoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0NhbGwgZGF0YWJhc2UnLCAoKSA9PiB7XG4gICAgY29uc3QgYXBwID0gc2dBcHAoKTtcbiAgICB0ZXN0KCdzaG91bGQgcmV0dXJuIGdldCBtb2RlbCcsICgpID0+IHtcbiAgICAgIGFwcC5kYiA9IHtcbiAgICAgICAgZ2V0TW9kZWw6IGplc3QuZm4oKCkgPT4gJ21vZGVsJyksXG4gICAgICB9O1xuICAgICAgZXhwZWN0KGFwcC5nZXRNb2RlbCgpKS50b0JlKCdtb2RlbCcpO1xuICAgICAgZXhwZWN0KGFwcC5kYi5nZXRNb2RlbCkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHJldHVybiBxdWVyeScsICgpID0+IHtcbiAgICAgIGFwcC5kYiA9IHtcbiAgICAgICAgcXVlcnk6IGplc3QuZm4oKCkgPT4gJ3F1ZXJ5JyksXG4gICAgICB9O1xuICAgICAgZXhwZWN0KGFwcC5xdWVyeSgpKS50b0JlKCdxdWVyeScpO1xuICAgICAgZXhwZWN0KGFwcC5kYi5xdWVyeSkudG9IYXZlQmVlbkNhbGxlZFRpbWVzKDEpO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19